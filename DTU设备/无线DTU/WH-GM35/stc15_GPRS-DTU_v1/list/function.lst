C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE FUNCTION
OBJECT MODULE PLACED IN .\list\function.obj
COMPILER INVOKED BY: D:\Program Files (x86)\Keil\C51\BIN\C51.EXE app\service\app\function.c LARGE BROWSE INCDIR(.\stclib
                    -;..\stc_lib;.\app;.\app\service\app;.\app\service\AES128;.\app\service\CRC16;.\app\service\GPRS) DEBUG OBJECTEXTEND CODE
                    - LISTINCLUDE SYMBOLS PRINT(.\list\function.lst) PREPRINT(.\list\function.i) OBJECT(.\list\function.obj)

line level    source

   1          #include "config.h"
   1      =1  
   2      =1  #ifndef         __CONFIG_H
   3      =1  #define         __CONFIG_H
   4      =1  
   5      =1  #include        "rtx51tny.h"
   1      =2  /*--------------------------------------------------------------------------
   2      =2  RTX51TNY.H
   3      =2  
   4      =2  Prototypes for RTX51 Tiny Real-Time Operating System Version 2.02
   5      =2  Copyright (c) 1988-2002 Keil Elektronik GmbH and Keil Software, Inc.
   6      =2  All rights reserved.
   7      =2  --------------------------------------------------------------------------*/
   8      =2  
   9      =2  #ifndef __RTX51TNY_H__
  10      =2  #define __RTX51TNY_H__
  11      =2  
  12      =2  
  13      =2  /* constants for os_wait function */
  14      =2  #define K_SIG      0x01              /* Wait for Signal   */
  15      =2  #define K_TMO      0x02              /* Wait for Timeout  */
  16      =2  #define K_IVL      0x80              /* Wait for Interval */
  17      =2  
  18      =2  /* function return values */
  19      =2  #define NOT_OK     0xFF              /* Parameter Error */
  20      =2  #define TMO_EVENT  0x08              /* Timeout Event   */
  21      =2  #define SIG_EVENT  0x04              /* Signal  Event   */
  22      =2  #define RDY_EVENT  0x80              /* Ready   Event   */
  23      =2  
  24      =2  extern unsigned char os_create_task     (unsigned char task_id);
  25      =2  extern unsigned char os_delete_task     (unsigned char task_id);
  26      =2  
  27      =2  extern unsigned char os_wait            (unsigned char typ, 
  28      =2                                           unsigned char ticks,
  29      =2                                           unsigned int dummy);
  30      =2  extern unsigned char os_wait1           (unsigned char typ);
  31      =2  extern unsigned char os_wait2           (unsigned char typ,
  32      =2                                           unsigned char ticks);
  33      =2  
  34      =2  extern unsigned char os_send_signal     (unsigned char task_id);
  35      =2  extern unsigned char os_clear_signal    (unsigned char task_id);
  36      =2  extern unsigned char isr_send_signal    (unsigned char task_id);
  37      =2  
  38      =2  extern void          os_set_ready       (unsigned char task_id);
  39      =2  extern void          isr_set_ready      (unsigned char task_id);
  40      =2  
  41      =2  extern unsigned char os_running_task_id (void);
  42      =2  extern unsigned char os_switch_task     (void); 
  43      =2  
  44      =2  extern void          os_reset_interval  (unsigned char ticks);
  45      =2  
  46      =2  #endif
   6      =1  
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 2   

   7      =1  /*********************************************************/
   8      =1  
   9      =1  //#define MAIN_Fosc             22118400L       //¶¨ÒåÖ÷Ê±ÖÓ
  10      =1  //#define MAIN_Fosc             12000000L       //¶¨ÒåÖ÷Ê±ÖÓ
  11      =1  #define MAIN_Fosc               11059200L       //¶¨ÒåÖ÷Ê±ÖÓ
  12      =1  //#define MAIN_Fosc              5529600L       //¶¨ÒåÖ÷Ê±ÖÓ
  13      =1  //#define MAIN_Fosc             24000000L       //¶¨ÒåÖ÷Ê±ÖÓ
  14      =1  typedef  unsigned int uint;
  15      =1  typedef  unsigned char uchar;
  16      =1  
  17      =1  /*********************************************************/
  18      =1  #include        "STC15Fxxxx.H"
   1      =2  
   2      =2  /*------------------------------------------------------------------*/
   3      =2  /* --- STC MCU International Limited -------------------------------*/
   4      =2  /* --- STC 1T Series MCU RC Demo -----------------------------------*/
   5      =2  /* --- Mobile: (86)13922805190 -------------------------------------*/
   6      =2  /* --- Fax: 86-0513-55012956,55012947,55012969 ---------------------*/
   7      =2  /* --- Tel: 86-0513-55012928,55012929,55012966 ---------------------*/
   8      =2  /* --- Web: www.GXWMCU.com -----------------------------------------*/
   9      =2  /* --- QQ:  800003751 ----------------------------------------------*/
  10      =2  /* If you want to use the program or the program referenced in the  */
  11      =2  /* article, please specify in which data and procedures from STC    */
  12      =2  /*------------------------------------------------------------------*/
  13      =2  
  14      =2  
  15      =2  
  16      =2  #ifndef _STC15Fxxxx_H
  17      =2  #define _STC15Fxxxx_H
  18      =2  
  19      =2  #include "config.h"
           =1 
           =1 
           =1 #include "stdlib.h"
           =1 #include <stdio.h>
           =1 #include <stdint.h>
           =1 
           =1 #endif
  19      =2  
  19      =2  /*------------------------------------------------------------------*/
  19      =2  /* --- STC MCU International Limited -------------------------------*/
  19      =2  /* --- STC 1T Series MCU RC Demo -----------------------------------*/
  19      =2  /* --- Mobile: (86)13922805190 -------------------------------------*/
  19      =2  /* --- Fax: 86-0513-55012956,55012947,55012969 ---------------------*/
  19      =2  /* --- Tel: 86-0513-55012928,55012929,55012966 ---------------------*/
  19      =2  /* --- Web: www.GXWMCU.com -----------------------------------------*/
  19      =2  /* --- QQ:  800003751 ----------------------------------------------*/
  19      =2  /* If you want to use the program or the program referenced in the  */
  19      =2  /* article, please specify in which data and procedures from STC    */
  19      =2  /*------------------------------------------------------------------*/
  19      =2  
  19      =2  
  19      =2  
  19      =2  #ifndef _STC15Fxxxx_H
  19      =2  #define _STC15Fxxxx_H
  19      =2  
  19      =2  #include "config.h"
  20      =2  
  21      =2  #include <intrins.h>
   1      =3  /*--------------------------------------------------------------------------
   2      =3  INTRINS.H
   3      =3  
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 3   

   4      =3  Intrinsic functions for C51.
   5      =3  Copyright (c) 1988-2004 Keil Elektronik GmbH and Keil Software, Inc.
   6      =3  All rights reserved.
   7      =3  --------------------------------------------------------------------------*/
   8      =3  
   9      =3  #ifndef __INTRINS_H__
  10      =3  #define __INTRINS_H__
  11      =3  
  12      =3  extern void          _nop_     (void);
  13      =3  extern bit           _testbit_ (bit);
  14      =3  extern unsigned char _cror_    (unsigned char, unsigned char);
  15      =3  extern unsigned int  _iror_    (unsigned int,  unsigned char);
  16      =3  extern unsigned long _lror_    (unsigned long, unsigned char);
  17      =3  extern unsigned char _crol_    (unsigned char, unsigned char);
  18      =3  extern unsigned int  _irol_    (unsigned int,  unsigned char);
  19      =3  extern unsigned long _lrol_    (unsigned long, unsigned char);
  20      =3  extern unsigned char _chkfloat_(float);
  21      =3  extern void          _push_    (unsigned char _sfr);
  22      =3  extern void          _pop_     (unsigned char _sfr);
  23      =3  
  24      =3  #endif
  25      =3  
  22      =2  
  23      =2  /*  BYTE Registers  */
  24      =2  sfr P0   = 0x80;
  25      =2  sfr SP   = 0x81;
  26      =2  sfr DPL  = 0x82;
  27      =2  sfr DPH  = 0x83;
  28      =2  sfr     S4CON = 0x84;
  29      =2  sfr     S4BUF = 0x85;
  30      =2  sfr PCON = 0x87;
  31      =2  
  32      =2  sfr TCON = 0x88;
  33      =2  sfr TMOD = 0x89;
  34      =2  sfr TL0  = 0x8A;
  35      =2  sfr TL1  = 0x8B;
  36      =2  sfr TH0  = 0x8C;
  37      =2  sfr TH1  = 0x8D;
  38      =2  sfr     AUXR = 0x8E;
  39      =2  sfr WAKE_CLKO = 0x8F;
  40      =2  sfr INT_CLKO = 0x8F;
  41      =2  sfr     AUXR2    = 0x8F;
  42      =2  
  43      =2  sfr RL_TL0  = 0x8A;
  44      =2  sfr RL_TL1  = 0x8B;
  45      =2  sfr RL_TH0  = 0x8C;
  46      =2  sfr RL_TH1  = 0x8D;
  47      =2  
  48      =2  
  49      =2  sfr P1   = 0x90;
  50      =2  sfr P1M1 = 0x91;        //P1M1.n,P1M0.n         =00--->Standard,        01--->push-pull         Êµ¼ÊÉÏ1TµÄ¶¼Ò»Ñù
  51      =2  sfr P1M0 = 0x92;        //                                      =10--->pure input,      11--->open drain
  52      =2  sfr P0M1 = 0x93;        //P0M1.n,P0M0.n         =00--->Standard,        01--->push-pull
  53      =2  sfr P0M0 = 0x94;        //                                      =10--->pure input,      11--->open drain
  54      =2  sfr P2M1 = 0x95;        //P2M1.n,P2M0.n         =00--->Standard,        01--->push-pull
  55      =2  sfr P2M0 = 0x96;        //                                      =10--->pure input,      11--->open drain
  56      =2  sfr CLK_DIV = 0x97;
  57      =2  sfr PCON2   = 0x97;
  58      =2  
  59      =2  sfr SCON  = 0x98;
  60      =2  sfr SBUF  = 0x99;
  61      =2  sfr S2CON = 0x9A;       //
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 4   

  62      =2  sfr S2BUF = 0x9B;       //
  63      =2  sfr P1ASF = 0x9D;       //Ö»Ð´£¬Ä£ÄâÊäÈë(AD»òLVD)Ñ¡Ôñ
  64      =2  
  65      =2  sfr P2    = 0xA0;
  66      =2  sfr BUS_SPEED = 0xA1;
  67      =2  sfr AUXR1 = 0xA2;
  68      =2  sfr P_SW1 = 0xA2;
  69      =2  
  70      =2  sfr IE    = 0xA8;
  71      =2  sfr SADDR = 0xA9;
  72      =2  sfr WKTCL = 0xAA;       //»½ÐÑ¶¨Ê±Æ÷µÍ×Ö½Ú
  73      =2  sfr WKTCH = 0xAB;       //»½ÐÑ¶¨Ê±Æ÷¸ß×Ö½Ú
  74      =2  sfr     S3CON = 0xAC;
  75      =2  sfr S3BUF = 0xAD;
  76      =2  sfr IE2   = 0xAF;       //STC12C5A60S2ÏµÁÐ
  77      =2  
  78      =2  sfr P3    = 0xB0;
  79      =2  sfr P3M1  = 0xB1;       //P3M1.n,P3M0.n         =00--->Standard,        01--->push-pull
  80      =2  sfr P3M0  = 0xB2;       //                                      =10--->pure input,      11--->open drain
  81      =2  sfr P4M1  = 0xB3;       //P4M1.n,P4M0.n         =00--->Standard,        01--->push-pull
  82      =2  sfr P4M0  = 0xB4;       //                                      =10--->pure input,      11--->open drain
  83      =2  sfr IP2   = 0xB5;       //STC12C5A60S2ÏµÁÐ
  84      =2  sfr IPH2  = 0xB6;       //STC12C5A60S2ÏµÁÐ
  85      =2  sfr IPH   = 0xB7;
  86      =2  
  87      =2  sfr IP        = 0xB8;
  88      =2  sfr SADEN     = 0xB9;
  89      =2  sfr     P_SW2     = 0xBA;
  90      =2  sfr ADC_CONTR = 0xBC;   //´øADÏµÁÐ
  91      =2  sfr ADC_RES   = 0xBD;   //´øADÏµÁÐ
  92      =2  sfr ADC_RESL  = 0xBE;   //´øADÏµÁÐ
  93      =2  
  94      =2  sfr P4        = 0xC0;
  95      =2  sfr WDT_CONTR = 0xC1;
  96      =2  sfr IAP_DATA  = 0xC2;
  97      =2  sfr IAP_ADDRH = 0xC3;
  98      =2  sfr IAP_ADDRL = 0xC4;
  99      =2  sfr IAP_CMD   = 0xC5;
 100      =2  sfr IAP_TRIG  = 0xC6;
 101      =2  sfr IAP_CONTR = 0xC7;
 102      =2  
 103      =2  sfr ISP_DATA  = 0xC2;
 104      =2  sfr ISP_ADDRH = 0xC3;
 105      =2  sfr ISP_ADDRL = 0xC4;
 106      =2  sfr ISP_CMD   = 0xC5;
 107      =2  sfr ISP_TRIG  = 0xC6;
 108      =2  sfr ISP_CONTR = 0xC7;
 109      =2  
 110      =2  sfr P5     = 0xC8;      //
 111      =2  sfr P5M1   = 0xC9;      //      P5M1.n,P5M0.n   =00--->Standard,        01--->push-pull
 112      =2  sfr P5M0   = 0xCA;      //                                      =10--->pure input,      11--->open drain
 113      =2  sfr P6M1   = 0xCB;      //      P5M1.n,P5M0.n   =00--->Standard,        01--->push-pull
 114      =2  sfr P6M0   = 0xCC;      //                                      =10--->pure input,      11--->open drain
 115      =2  sfr SPSTAT = 0xCD;      //
 116      =2  sfr SPCTL  = 0xCE;      //
 117      =2  sfr SPDAT  = 0xCF;      //
 118      =2  
 119      =2  sfr PSW  = 0xD0;
 120      =2  sfr     T4T3M = 0xD1;
 121      =2  sfr     T4H  = 0xD2;
 122      =2  sfr     T4L  = 0xD3;
 123      =2  sfr     T3H  = 0xD4;
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 5   

 124      =2  sfr     T3L  = 0xD5;
 125      =2  sfr     T2H  = 0xD6;
 126      =2  sfr     T2L  = 0xD7;
 127      =2  
 128      =2  sfr     TH4  = 0xD2;
 129      =2  sfr     TL4  = 0xD3;
 130      =2  sfr     TH3  = 0xD4;
 131      =2  sfr     TL3  = 0xD5;
 132      =2  sfr     TH2  = 0xD6;
 133      =2  sfr     TL2  = 0xD7;
 134      =2  
 135      =2  sfr     RL_T4H  = 0xD2;
 136      =2  sfr     RL_T4L  = 0xD3;
 137      =2  sfr     RL_T3H  = 0xD4;
 138      =2  sfr     RL_T3L  = 0xD5;
 139      =2  sfr     RL_T2H  = 0xD6;
 140      =2  sfr     RL_T2L  = 0xD7;
 141      =2  
 142      =2  sfr CCON = 0xD8;        //
 143      =2  sfr CMOD = 0xD9;        //
 144      =2  sfr CCAPM0 = 0xDA;      //PCAÄ£¿é0µÄ¹¤×÷Ä£Ê½¼Ä´æÆ÷¡£
 145      =2  sfr CCAPM1 = 0xDB;      //PCAÄ£¿é1µÄ¹¤×÷Ä£Ê½¼Ä´æÆ÷¡£
 146      =2  sfr CCAPM2 = 0xDC;      //PCAÄ£¿é2µÄ¹¤×÷Ä£Ê½¼Ä´æÆ÷¡£
 147      =2  
 148      =2  sfr ACC    = 0xE0;
 149      =2  sfr     P7M1   = 0xE1;
 150      =2  sfr     P7M0   = 0xE2;
 151      =2  sfr     CMPCR1 = 0xE6;
 152      =2  sfr     CMPCR2 = 0xE7;
 153      =2  
 154      =2  
 155      =2  sfr     P6     = 0xE8;
 156      =2  sfr CL     = 0xE9;      //
 157      =2  sfr CCAP0L = 0xEA;      //PCAÄ£¿é0µÄ²¶×½/±È½Ï¼Ä´æÆ÷µÍ8Î»¡£
 158      =2  sfr CCAP1L = 0xEB;      //PCAÄ£¿é1µÄ²¶×½/±È½Ï¼Ä´æÆ÷µÍ8Î»¡£
 159      =2  sfr CCAP2L = 0xEC;      //PCAÄ£¿é2µÄ²¶×½/±È½Ï¼Ä´æÆ÷µÍ8Î»¡£
 160      =2  
 161      =2  sfr B      = 0xF0;
 162      =2  sfr PCA_PWM0 = 0xF2;    //PCAÄ£¿é0 PWM¼Ä´æÆ÷¡£
 163      =2  sfr PCA_PWM1 = 0xF3;    //PCAÄ£¿é1 PWM¼Ä´æÆ÷¡£
 164      =2  sfr PCA_PWM2 = 0xF4;    //PCAÄ£¿é2 PWM¼Ä´æÆ÷¡£
 165      =2  
 166      =2  sfr     P7     = 0xF8;
 167      =2  sfr CH     = 0xF9;
 168      =2  sfr CCAP0H = 0xFA;              //PCAÄ£¿é0µÄ²¶×½/±È½Ï¼Ä´æÆ÷¸ß8Î»¡£
 169      =2  sfr CCAP1H = 0xFB;              //PCAÄ£¿é1µÄ²¶×½/±È½Ï¼Ä´æÆ÷¸ß8Î»¡£
 170      =2  sfr CCAP2H = 0xFC;              //PCAÄ£¿é2µÄ²¶×½/±È½Ï¼Ä´æÆ÷¸ß8Î»¡£
 171      =2  
 172      =2  
 173      =2  /*  BIT Registers  */
 174      =2  /*  PSW   */
 175      =2  sbit CY   = PSW^7;
 176      =2  sbit AC   = PSW^6;
 177      =2  sbit F0   = PSW^5;
 178      =2  sbit RS1  = PSW^4;
 179      =2  sbit RS0  = PSW^3;
 180      =2  sbit OV   = PSW^2;
 181      =2  sbit F1   = PSW^1;
 182      =2  sbit P    = PSW^0;
 183      =2  
 184      =2  /*  TCON  */
 185      =2  sbit TF1  = TCON^7;     //¶¨Ê±Æ÷1Òç³öÖÐ¶Ï±êÖ¾Î»
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 6   

 186      =2  sbit TR1  = TCON^6;     //¶¨Ê±Æ÷1ÔËÐÐ¿ØÖÆÎ»
 187      =2  sbit TF0  = TCON^5;     //¶¨Ê±Æ÷0Òç³öÖÐ¶Ï±êÖ¾Î»
 188      =2  sbit TR0  = TCON^4;     //¶¨Ê±Æ÷0ÔËÐÐ¿ØÖÆÎ»
 189      =2  sbit IE1  = TCON^3;     //ÍâÖÐ¶Ï1±êÖ¾Î»
 190      =2  sbit IT1  = TCON^2;     //ÍâÖÐ¶Ï1ÐÅºÅ·½Ê½¿ØÖÆÎ»£¬1£ºÏÂ½µÑØÖÐ¶Ï£¬0£ºÉÏÉýÏÂ½µ¾ùÖÐ¶Ï¡£
 191      =2  sbit IE0  = TCON^1;     //ÍâÖÐ¶Ï0±êÖ¾Î»
 192      =2  sbit IT0  = TCON^0;     //ÍâÖÐ¶Ï0ÐÅºÅ·½Ê½¿ØÖÆÎ»£¬1£ºÏÂ½µÑØÖÐ¶Ï£¬0£ºÉÏÉýÏÂ½µ¾ùÖÐ¶Ï¡£
 193      =2  
 194      =2  /*  P0  */
 195      =2  sbit  P00 = P0^0;
 196      =2  sbit  P01 = P0^1;
 197      =2  sbit  P02 = P0^2;
 198      =2  sbit  P03 = P0^3;
 199      =2  sbit  P04 = P0^4;
 200      =2  sbit  P05 = P0^5;
 201      =2  sbit  P06 = P0^6;
 202      =2  sbit  P07 = P0^7;
 203      =2  
 204      =2  /*  P1  */
 205      =2  sbit  P10 = P1^0;
 206      =2  sbit  P11 = P1^1;
 207      =2  sbit  P12 = P1^2;
 208      =2  sbit  P13 = P1^3;
 209      =2  sbit  P14 = P1^4;
 210      =2  sbit  P15 = P1^5;
 211      =2  sbit  P16 = P1^6;
 212      =2  sbit  P17 = P1^7;
 213      =2  
 214      =2  sbit  RXD2      = P1^0;
 215      =2  sbit  TXD2      = P1^1;
 216      =2  sbit  CCP1      = P1^0;
 217      =2  sbit  CCP0      = P1^1;
 218      =2  sbit  SPI_SS    = P1^2;
 219      =2  sbit  SPI_MOSI  = P1^3;
 220      =2  sbit  SPI_MISO  = P1^4;
 221      =2  sbit  SPI_SCLK  = P1^5;
 222      =2  
 223      =2  /*  P2  */
 224      =2  sbit  P20 = P2^0;
 225      =2  sbit  P21 = P2^1;
 226      =2  sbit  P22 = P2^2;
 227      =2  sbit  P23 = P2^3;
 228      =2  sbit  P24 = P2^4;
 229      =2  sbit  P25 = P2^5;
 230      =2  sbit  P26 = P2^6;
 231      =2  sbit  P27 = P2^7;
 232      =2  
 233      =2  /*  P3  */
 234      =2  sbit  P30 = P3^0;
 235      =2  sbit  P31 = P3^1;
 236      =2  sbit  P32 = P3^2;
 237      =2  sbit  P33 = P3^3;
 238      =2  sbit  P34 = P3^4;
 239      =2  sbit  P35 = P3^5;
 240      =2  sbit  P36 = P3^6;
 241      =2  sbit  P37 = P3^7;
 242      =2  
 243      =2  sbit RXD  = P3^0;
 244      =2  sbit TXD  = P3^1;
 245      =2  sbit INT0 = P3^2;
 246      =2  sbit INT1 = P3^3;
 247      =2  sbit T0   = P3^4;
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 7   

 248      =2  sbit T1   = P3^5;
 249      =2  sbit WR   = P3^6;
 250      =2  sbit RD   = P3^7;
 251      =2  sbit CCP2  = P3^7;
 252      =2  
 253      =2  sbit CLKOUT0   = P3^5;
 254      =2  sbit CLKOUT1   = P3^4;
 255      =2  
 256      =2  /*  P4  */
 257      =2  sbit  P40 = P4^0;
 258      =2  sbit  P41 = P4^1;
 259      =2  sbit  P42 = P4^2;
 260      =2  sbit  P43 = P4^3;
 261      =2  sbit  P44 = P4^4;
 262      =2  sbit  P45 = P4^5;
 263      =2  sbit  P46 = P4^6;
 264      =2  sbit  P47 = P4^7;
 265      =2  
 266      =2  /*  P5  */
 267      =2  sbit  P50 = P5^0;
 268      =2  sbit  P51 = P5^1;
 269      =2  sbit  P52 = P5^2;
 270      =2  sbit  P53 = P5^3;
 271      =2  sbit  P54 = P5^4;
 272      =2  sbit  P55 = P5^5;
 273      =2  sbit  P56 = P5^6;
 274      =2  sbit  P57 = P5^7;
 275      =2  
 276      =2  /*  SCON  */
 277      =2  sbit SM0  = SCON^7;     //SM0/FE                SM0 SM1 = 00 ~ 11: ·½Ê½0~3
 278      =2  sbit SM1  = SCON^6;     //
 279      =2  sbit SM2  = SCON^5;     //¶à»úÍ¨Ñ¶
 280      =2  sbit REN  = SCON^4;     //½ÓÊÕÔÊÐí
 281      =2  sbit TB8  = SCON^3;     //·¢ËÍÊý¾ÝµÚ8Î»
 282      =2  sbit RB8  = SCON^2;     //½ÓÊÕÊý¾ÝµÚ8Î»
 283      =2  sbit TI   = SCON^1;     //·¢ËÍÖÐ¶Ï±êÖ¾Î»
 284      =2  sbit RI   = SCON^0;     //½ÓÊÕÖÐ¶Ï±êÖ¾Î»
 285      =2  
 286      =2  /*  IE   */
 287      =2  sbit EA   = IE^7;       //ÖÐ¶ÏÔÊÐí×Ü¿ØÖÆÎ»
 288      =2  sbit ELVD = IE^6;       //µÍÑ¹¼à²âÖÐ¶ÏÔÊÐíÎ»
 289      =2  sbit EADC = IE^5;       //ADC ÖÐ¶Ï ÔÊÐíÎ»
 290      =2  sbit ES   = IE^4;       //´®ÐÐÖÐ¶Ï ÔÊÐí¿ØÖÆÎ»
 291      =2  sbit ET1  = IE^3;       //¶¨Ê±ÖÐ¶Ï1ÔÊÐí¿ØÖÆÎ»
 292      =2  sbit EX1  = IE^2;       //Íâ²¿ÖÐ¶Ï1ÔÊÐí¿ØÖÆÎ»
 293      =2  sbit ET0  = IE^1;       //¶¨Ê±ÖÐ¶Ï0ÔÊÐí¿ØÖÆÎ»
 294      =2  sbit EX0  = IE^0;       //Íâ²¿ÖÐ¶Ï0ÔÊÐí¿ØÖÆÎ»
 295      =2  
 296      =2  
 297      =2  /*  IP   */ 
 298      =2  /*
 299      =2  sbit PPCA = IP^7;       //PCA ÖÐ¶Ï ÓÅÏÈ¼¶Éè¶¨Î»
 300      =2  sbit PLVD = IP^6;       //µÍÑ¹ÖÐ¶Ï ÓÅÏÈ¼¶Éè¶¨Î»
 301      =2  sbit PADC = IP^5;       //ADC ÖÐ¶Ï ÓÅÏÈ¼¶Éè¶¨Î»
 302      =2  sbit PS   = IP^4;       //´®ÐÐÖÐ¶Ï0ÓÅÏÈ¼¶Éè¶¨Î»
 303      =2  sbit PT1  = IP^3;       //¶¨Ê±ÖÐ¶Ï1ÓÅÏÈ¼¶Éè¶¨Î»
 304      =2  sbit PX1  = IP^2;       //Íâ²¿ÖÐ¶Ï1ÓÅÏÈ¼¶Éè¶¨Î»
 305      =2  sbit PT0  = IP^1;       //¶¨Ê±ÖÐ¶Ï0ÓÅÏÈ¼¶Éè¶¨Î»
 306      =2  sbit PX0  = IP^0;       //Íâ²¿ÖÐ¶Ï0ÓÅÏÈ¼¶Éè¶¨Î»
 307      =2  */
 308      =2  
 309      =2  sbit ACC0 = ACC^0;
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 8   

 310      =2  sbit ACC1 = ACC^1;
 311      =2  sbit ACC2 = ACC^2;
 312      =2  sbit ACC3 = ACC^3;
 313      =2  sbit ACC4 = ACC^4;
 314      =2  sbit ACC5 = ACC^5;
 315      =2  sbit ACC6 = ACC^6;
 316      =2  sbit ACC7 = ACC^7;
 317      =2  
 318      =2  sbit B0 = B^0;
 319      =2  sbit B1 = B^1;
 320      =2  sbit B2 = B^2;
 321      =2  sbit B3 = B^3;
 322      =2  sbit B4 = B^4;
 323      =2  sbit B5 = B^5;
 324      =2  sbit B6 = B^6;
 325      =2  sbit B7 = B^7;
 326      =2  
 327      =2  
 328      =2  //                                                      7     6     5    4    3    2    1     0    Reset Value
 329      =2  //sfr IE2       = 0xAF;         -     -     -    -    -    -   ESPI  ES2   0000,0000B   //Auxiliary Interrupt   
 330      =2  #define         SPI_INT_ENABLE()                IE2 |=  2       //ÔÊÐíSPIÖÐ¶Ï
 331      =2  #define         SPI_INT_DISABLE()               IE2 &= ~2       //ÔÊÐíSPIÖÐ¶Ï
 332      =2  #define         UART2_INT_ENABLE()              IE2 |=  1       //ÔÊÐí´®¿Ú2ÖÐ¶Ï
 333      =2  #define         UART2_INT_DISABLE()             IE2 &= ~1       //ÔÊÐí´®¿Ú2ÖÐ¶Ï
 334      =2  
 335      =2  //                                          7     6     5    4    3    2    1    0    Reset Value
 336      =2  //sfr IP      = 0xB8; //ÖÐ¶ÏÓÅÏÈ¼¶µÍÎ»      PPCA  PLVD  PADC  PS   PT1  PX1  PT0  PX0   0000,0000
 337      =2  //--------
 338      =2  sbit PPCA       = IP^7; //PCA Ä£¿éÖÐ¶ÏÓÅÏÈ¼¶
 339      =2  sbit PLVD       = IP^6; //µÍÑ¹¼à²âÖÐ¶ÏÓÅÏÈ¼¶
 340      =2  sbit PADC       = IP^5; //ADC ÖÐ¶ÏÓÅÏÈ¼¶
 341      =2  sbit PS         = IP^4; //´®ÐÐÖÐ¶Ï0ÓÅÏÈ¼¶Éè¶¨Î»
 342      =2  sbit PT1        = IP^3; //¶¨Ê±ÖÐ¶Ï1ÓÅÏÈ¼¶Éè¶¨Î»
 343      =2  sbit PX1        = IP^2; //Íâ²¿ÖÐ¶Ï1ÓÅÏÈ¼¶Éè¶¨Î»
 344      =2  sbit PT0        = IP^1; //¶¨Ê±ÖÐ¶Ï0ÓÅÏÈ¼¶Éè¶¨Î»
 345      =2  sbit PX0        = IP^0; //Íâ²¿ÖÐ¶Ï0ÓÅÏÈ¼¶Éè¶¨Î»
 346      =2  
 347      =2  //                                           7      6      5     4     3     2    1     0        Reset Val
             -ue
 348      =2  //sfr IPH   = 0xB7; //ÖÐ¶ÏÓÅÏÈ¼¶¸ßÎ»       PPCAH  PLVDH  PADCH  PSH  PT1H  PX1H  PT0H  PX0H   0000,0000
 349      =2  //sfr IP2   = 0xB5; //                       -      -      -     -     -     -   PSPI   PS2   xxxx,xx00
 350      =2  //sfr IPH2  = 0xB6; //                       -      -      -     -     -     -   PSPIH  PS2H  xxxx,xx00
 351      =2  #define         PPCAH   0x80
 352      =2  #define         PLVDH   0x40
 353      =2  #define         PADCH   0x20
 354      =2  #define         PSH             0x10
 355      =2  #define         PT1H    0x08
 356      =2  #define         PX1H    0x04
 357      =2  #define         PT0H    0x02
 358      =2  #define         PX0H    0x01
 359      =2  
 360      =2  #define         PCA_InterruptFirst()    PPCA = 1
 361      =2  #define         LVD_InterruptFirst()    PLVD = 1
 362      =2  #define         ADC_InterruptFirst()    PADC = 1
 363      =2  #define         UART1_InterruptFirst()  PS   = 1
 364      =2  #define         Timer1_InterruptFirst() PT1  = 1
 365      =2  #define         INT1_InterruptFirst()   PX1  = 1
 366      =2  #define         Timer0_InterruptFirst() PT0  = 1
 367      =2  #define         INT0_InterruptFirst()   PX0  = 1
 368      =2  
 369      =2  
 370      =2  /*************************************************************************************************/
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 9   

 371      =2  
 372      =2  
 373      =2  
 374      =2  /*************************************************************************************************/
 375      =2  #define         S1_DoubleRate()         PCON |= 0x80
 376      =2  #define         S1_SHIFT()                      SCON &= 0x3f
 377      =2  #define         S1_8bit()                       SCON  = (SCON & 0x3f) | 0x40
 378      =2  #define         S1_9bit()                       SCON  = (SCON & 0x3f) | 0xc0
 379      =2  #define         S1_RX_Enable()          SCON |= 0x10
 380      =2  #define         S1_USE_P30P31()         P_SW1 &= ~0xc0                                  //UART1 Ê¹ÓÃP30 P31¿Ú   Ä¬ÈÏ
 381      =2  #define         S1_USE_P36P37()         P_SW1 = (P_SW1 & ~0xc0) | 0x40  //UART1 Ê¹ÓÃP36 P37¿Ú
 382      =2  #define         S1_USE_P16P17()         P_SW1 = (P_SW1 & ~0xc0) | 0x80  //UART1 Ê¹ÓÃP16 P17¿Ú
 383      =2  #define         S1_TXD_RXD_SHORT()      PCON2 |=  (1<<4)        //½«TXDÓëRXDÁ¬½ÓÖÐ¼ÌÊä³ö
 384      =2  #define         S1_TXD_RXD_OPEN()       PCON2 &= ~(1<<4)        //½«TXDÓëRXDÁ¬½ÓÖÐ¼Ì¶Ï¿ª        Ä¬ÈÏ
 385      =2  #define         S1_BRT_UseTimer2()      AUXR |=  1
 386      =2  #define         S1_BRT_UseTimer1()      AUXR &= ~1
 387      =2  
 388      =2  //                                                7      6      5      4      3      2     1     0        Reset Value
 389      =2  //sfr S2CON = 0x9A;             S2SM0    -    S2SM2  S2REN  S2TB8  S2RB8  S2TI  S2RI      00000000B              //S2 Control
 390      =2  
 391      =2  #define         S2_8bit()                       S2CON &= ~(1<<7)                //´®¿Ú2Ä£Ê½0£¬8Î»UART£¬²¨ÌØÂÊ = ¶¨Ê±Æ÷2µÄÒç³öÂÊ / 4
 392      =2  #define         S2_9bit()                       S2CON |=  (1<<7)                //´®¿Ú2Ä£Ê½1£¬9Î»UART£¬²¨ÌØÂÊ = ¶¨Ê±Æ÷2µÄÒç³öÂÊ / 4
 393      =2  #define         S2_RX_Enable()          S2CON |=  (1<<4)                //ÔÊÐí´®2½ÓÊÕ
 394      =2  
 395      =2  #define         S2_MODE0()                      S2CON &= ~(1<<7)                //´®¿Ú2Ä£Ê½0£¬8Î»UART£¬²¨ÌØÂÊ = ¶¨Ê±Æ÷2µÄÒç³öÂÊ / 4
 396      =2  #define         S2_MODE1()                      S2CON |=  (1<<7)                //´®¿Ú2Ä£Ê½1£¬9Î»UART£¬²¨ÌØÂÊ = ¶¨Ê±Æ÷2µÄÒç³öÂÊ / 4
 397      =2  #define         S2_RX_EN()                      S2CON |=  (1<<4)                                                        //ÔÊÐí´®2½ÓÊÕ
 398      =2  #define         S2_RX_Disable()         S2CON &= ~(1<<4)                                                        //½ûÖ¹´®2½ÓÊÕ
 399      =2  #define         TI2                                     (S2CON & 2) != 0
 400      =2  #define         RI2                                     (S2CON & 1) != 0
 401      =2  #define         SET_TI2()                       S2CON |=  2
 402      =2  #define         CLR_TI2()                       S2CON &= ~2
 403      =2  #define         CLR_RI2()                       S2CON &= ~1
 404      =2  #define         S2TB8_SET()                     S2CON |=  8
 405      =2  #define         S2TB8_CLR()                     S2CON &= ~8
 406      =2  #define         S2_Int_en()                     IE2   |=  1             //´®¿Ú2ÔÊÐíÖÐ¶Ï
 407      =2  #define         S2_USE_P10P11()         P_SW2 &= ~1             //UART2 Ê¹ÓÃP1¿Ú        Ä¬ÈÏ
 408      =2  #define         S2_USE_P46P47()         P_SW2 |=  1             //UART2 Ê¹ÓÃP4¿Ú
 409      =2  
 410      =2  #define         S3_USE_P00P01()         P_SW2 &= ~2             //UART3 Ê¹ÓÃP0¿Ú        Ä¬ÈÏ
 411      =2  #define         S3_USE_P50P51()         P_SW2 |=  2             //UART3 Ê¹ÓÃP5¿Ú
 412      =2  #define         S4_USE_P02P03()         P_SW2 &= ~4             //UART4 Ê¹ÓÃP0¿Ú        Ä¬ÈÏ
 413      =2  #define         S4_USE_P52P53()         P_SW2 |=  4             //UART4 Ê¹ÓÃP5¿Ú
 414      =2  
 415      =2  
 416      =2  /**********************************************************/
 417      =2  
 418      =2  #define         Timer0_16bitAutoReload()        TMOD &= ~0x03                                   //16Î»×Ô¶¯ÖØ×°
 419      =2  #define         Timer0_16bit()                          TMOD  = (TMOD & ~0x03) | 0x01   //16Î»
 420      =2  #define         Timer0_8bitAutoReload()         TMOD  = (TMOD & ~0x03) | 0x02   //8Î»×Ô¶¯ÖØ×°
 421      =2  #define         Timer0_16bitAutoRL_NoMask()     TMOD |=  0x03           //16Î»×Ô¶¯ÖØ×°²»¿ÉÆÁ±ÎÖÐ¶Ï
 422      =2  #define         Timer0_AsCounterP32()           TMOD |=  4              //Ê±Æ÷0ÓÃ×ö¼ÆÊýÆ÷
 423      =2  #define         Timer0_AsTimer()                        TMOD &= ~4              //Ê±Æ÷0ÓÃ×ö¶¨Ê±Æ÷
 424      =2  #define         Timer0_ExtControlP34()          TMOD |=  4              //Ê±Æ÷0ÓÉÍâ²¿INT0¸ßµçÆ½ÔÊÐí¶¨Ê±¼ÆÊý
 425      =2  #define         Timer0_Run()                            TR0 = 1                         //ÔÊÐí¶¨Ê±Æ÷0¼ÆÊý
 426      =2  #define         Timer0_Stop()                           TR0 = 0                         //½ûÖ¹¶¨Ê±Æ÷0¼ÆÊý
 427      =2  #define         Timer0_InterruptEnable()        ET0 = 1                         //ÔÊÐíTimer1ÖÐ¶Ï.
 428      =2  #define         Timer0_InterruptDisable()       ET0 = 0                         //½ûÖ¹Timer1ÖÐ¶Ï.
 429      =2  
 430      =2  #define         Timer1_16bitAutoReload()        TMOD &= ~0x30                                   //16Î»×Ô¶¯ÖØ×°
 431      =2  #define         Timer1_16bit()                          TMOD  = (TMOD & ~0x30) | 0x10   //16Î»
 432      =2  #define         Timer1_8bitAutoReload()         TMOD  = (TMOD & ~0x30) | 0x20   //8Î»×Ô¶¯ÖØ×°
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 10  

 433      =2  #define         Timer1_16bitAutoRL_NoMask()     TMOD |=  0x30           //16Î»×Ô¶¯ÖØ×°²»¿ÉÆÁ±ÎÖÐ¶Ï
 434      =2  #define         Timer1_AsCounterP33()           TMOD |=  (1<<6)         //Ê±Æ÷1ÓÃ×ö¼ÆÊýÆ÷
 435      =2  #define         Timer1_AsTimer()                        TMOD &= ~(1<<6)         //Ê±Æ÷1ÓÃ×ö¶¨Ê±Æ÷
 436      =2  #define         Timer1_ExtControlP35()          TMOD |=  (1<<7)         //Ê±Æ÷1ÓÉÍâ²¿INT1¸ßµçÆ½ÔÊÐí¶¨Ê±¼ÆÊý
 437      =2  #define         Timer1_Run()                            TR1 = 1                         //ÔÊÐí¶¨Ê±Æ÷1¼ÆÊý
 438      =2  #define         Timer1_Stop()                           TR1 = 0                         //½ûÖ¹¶¨Ê±Æ÷1¼ÆÊý
 439      =2  #define         Timer1_InterruptEnable()        ET1 = 1                         //ÔÊÐíTimer1ÖÐ¶Ï.
 440      =2  #define         Timer1_InterruptDisable()       ET1 = 0                         //½ûÖ¹Timer1ÖÐ¶Ï.
 441      =2  
 442      =2  
 443      =2  //                                                 7     6       5      4     3      2      1      0    Reset Value
 444      =2  //sfr AUXR  = 0x8E;             T0x12 T1x12 UART_M0x6  T2R  T2_C/T T2x12 EXTRAM  S1ST2  0000,0000       //Auxiliary Registe
             -r 
 445      =2  
 446      =2  #define         Timer0_1T()                                     AUXR |=  (1<<7) //Timer0 clodk = fo
 447      =2  #define         Timer0_12T()                            AUXR &= ~(1<<7) //Timer0 clodk = fo/12  12·ÖÆµ, default
 448      =2  #define         Timer1_1T()                                     AUXR |=  (1<<6) //Timer1 clodk = fo
 449      =2  #define         Timer1_12T()                            AUXR &= ~(1<<6) //Timer1 clodk = fo/12  12·ÖÆµ, default
 450      =2  #define         S1_M0x6()                                       AUXR |=  (1<<5) //UART Mode0 Speed is 6x Standard
 451      =2  #define         S1_M0x1()                                       AUXR &= ~(1<<5) //default,      UART Mode0 Speed is Standard
 452      =2  #define         Timer2_Run()                            AUXR |=  (1<<4) //ÔÊÐí¶¨Ê±Æ÷2¼ÆÊý
 453      =2  #define         Timer2_Stop()                           AUXR &= ~(1<<4) //½ûÖ¹¶¨Ê±Æ÷2¼ÆÊý
 454      =2  #define         Timer2_AsCounterP31()           AUXR |=  (1<<3) //Ê±Æ÷2ÓÃ×ö¼ÆÊýÆ÷
 455      =2  #define         Timer2_AsTimer()                        AUXR &= ~(1<<3) //Ê±Æ÷2ÓÃ×ö¶¨Ê±Æ÷
 456      =2  #define         Timer2_1T()                                     AUXR |=  (1<<2) //Timer0 clodk = fo
 457      =2  #define         Timer2_12T()                            AUXR &= ~(1<<2) //Timer0 clodk = fo/12  12·ÖÆµ, default
 458      =2  #define         Timer2_InterruptEnable()        IE2  |=  (1<<2) //ÔÊÐíTimer2ÖÐ¶Ï.
 459      =2  #define         Timer2_InterruptDisable()       IE2  &= ~(1<<2) //½ûÖ¹Timer2ÖÐ¶Ï.
 460      =2  
 461      =2  #define         ExternalRAM_enable()            AUXR |=  2              //ÔÊÐíÍâ²¿XRAM£¬½ûÖ¹Ê¹ÓÃÄÚ²¿1024RAM
 462      =2  #define         InternalRAM_enable()            AUXR &= ~2              //½ûÖ¹Íâ²¿XRAM£¬ÔÊÐíÊ¹ÓÃÄÚ²¿1024RAM
 463      =2  
 464      =2  #define         T0_pulseP34_enable()            AUXR2 |=  1             //ÔÊÐí T0 Òç³öÂö³åÔÚT0(P3.5)½ÅÊä³ö£¬Fck0 = 1/2 T0 Òç³öÂÊ£¬T0¿É
             -ÒÔ1T»ò12T¡£
 465      =2  #define         T0_pulseP34_disable()           AUXR2 &= ~1
 466      =2  #define         T1_pulseP35_enable()            AUXR2 |=  2             //ÔÊÐí T1 Òç³öÂö³åÔÚT1(P3.4)½ÅÊä³ö£¬Fck1 = 1/2 T1 Òç³öÂÊ£¬T1¿É
             -ÒÔ1T»ò12T¡£
 467      =2  #define         T1_pulseP35_disable()           AUXR2 &= ~2
 468      =2  #define         T2_pulseP30_enable()            AUXR2 |=  4             //ÔÊÐí T2 Òç³öÂö³åÔÚT1(P3.0)½ÅÊä³ö£¬Fck2 = 1/2 T2 Òç³öÂÊ£¬T2¿É
             -ÒÔ1T»ò12T¡£
 469      =2  #define         T2_pulseP30_disable()           AUXR2 &= ~4
 470      =2  
 471      =2  #define         T0_pulseP35(n)          ET0=0,Timer0_AsTimer(),Timer0_1T(),Timer0_16bitAutoReload(),TH0=(65536-(n/2+MAIN_
             -Fosc/2)/(n))/256,TL0=(65536-(n/2+MAIN_Fosc/2)/(n))%256,AUXR2 |= bit0,TR0=1            //fx=fosc/(2*M)/n,  M=1 or M=12
 472      =2  #define         T1_pulseP34(n)          ET1=0,Timer1_AsTimer(),Timer1_1T(),Timer1_16bitAutoReload(),TH1=(65536-(n/2+MAIN_
             -Fosc/2)/(n))/256,TL1=(65536-(n/2+MAIN_Fosc/2)/(n))%256,AUXR2 |= bit1,TR1=1            //fx=fosc/(2*M)/n,  M=1 or M=12
 473      =2  #define         T2_pulseP30(n)          Timer2_InterruptDisable(),Timer2_AsTimer(),Timer2_1T(),TH2=(65536-(n/2+MAIN_Fosc/
             -2)/(n))/256,TL2=(65536-(n/2+MAIN_Fosc/2)/(n))%256,AUXR2 |= bit2,Timer2_Run()  //fx=fosc/(2*M)/n,  M=1 or M=12
 474      =2  
 475      =2  #define         Timer0_Load(n)          TH0 = (n) / 256,        TL0 = (n) % 256
 476      =2  #define         Timer1_Load(n)          TH1 = (n) / 256,        TL1 = (n) % 256
 477      =2  #define         Timer2_Load(n)          TH2 = (n) / 256,        TL2 = (n) % 256
 478      =2  
 479      =2  #define         Timer0_Load_us(n)       TH0=(65536-MainFosc_KHZ*(n)/1000)/256,TL0=(65536-MainFosc_KHZ*(n)/1000)%256
 480      =2  #define         Timer1_Load_us(n)       TH1=(65536-MainFosc_KHZ*(n)/1000)/256,TL1=(65536-MainFosc_KHZ*(n)/1000)%256
 481      =2  #define         Timer2_Load_us(n)       TH2=(65536-MainFosc_KHZ*(n)/1000)/256,TL2=(65536-MainFosc_KHZ*(n)/1000)%256
 482      =2  
 483      =2  
 484      =2  //sfr WDT_CONTR = 0xC1; //Watch-Dog-Timer Control register
 485      =2  //                                      7     6     5      4       3      2   1   0     Reset Value
 486      =2  //                                  WDT_FLAG  -  EN_WDT CLR_WDT IDLE_WDT PS2 PS1 PS0    xx00,0000
 487      =2  #define D_WDT_FLAG                      (1<<7)
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 11  

 488      =2  #define D_EN_WDT                        (1<<5)
 489      =2  #define D_CLR_WDT                       (1<<4)  //auto clear
 490      =2  #define D_IDLE_WDT                      (1<<3)  //WDT counter when Idle
 491      =2  #define D_WDT_SCALE_2           0
 492      =2  #define D_WDT_SCALE_4           1
 493      =2  #define D_WDT_SCALE_8           2               //T=393216*N/fo
 494      =2  #define D_WDT_SCALE_16          3
 495      =2  #define D_WDT_SCALE_32          4
 496      =2  #define D_WDT_SCALE_64          5
 497      =2  #define D_WDT_SCALE_128         6
 498      =2  #define D_WDT_SCALE_256         7
 499      =2  
 500      =2  #define WDT_reset(n)    WDT_CONTR = D_EN_WDT + D_CLR_WDT + D_IDLE_WDT + (n)             //³õÊ¼»¯WDT£¬Î¹¹·
 501      =2  
 502      =2  
 503      =2  //                                                7     6      5    4     3      2    1     0     Reset Value
 504      =2  //sfr PCON   = 0x87;    SMOD  SMOD0  LVDF  POF   GF1    GF0   PD   IDL    0001,0000      //Power Control 
 505      =2  //SMOD          //´®¿ÚË«±¶ËÙ
 506      =2  //SMOD0
 507      =2  #define         LVDF            (1<<5)  //P4.6µÍÑ¹¼ì²â±êÖ¾
 508      =2  //POF
 509      =2  //GF1
 510      =2  //GF0
 511      =2  //#define       D_PD            2               //set 1, power down mode
 512      =2  //#define       D_IDLE          1               //set 1, idle mode
 513      =2  #define         MCU_IDLE()                      PCON |= 1       //MCU ½øÈë IDLE Ä£Ê½
 514      =2  #define         MCU_POWER_DOWN()        PCON |= 2       //MCU ½øÈë Ë¯Ãß Ä£Ê½
 515      =2  
 516      =2  
 517      =2  //sfr ISP_CMD   = 0xC5;
 518      =2  #define         ISP_STANDBY()   ISP_CMD = 0             //ISP¿ÕÏÐÃüÁî£¨½ûÖ¹£©
 519      =2  #define         ISP_READ()              ISP_CMD = 1             //ISP¶Á³öÃüÁî
 520      =2  #define         ISP_WRITE()             ISP_CMD = 2             //ISPÐ´ÈëÃüÁî
 521      =2  #define         ISP_ERASE()             ISP_CMD = 3             //ISP²Á³ýÃüÁî
 522      =2  
 523      =2  //sfr ISP_TRIG  = 0xC6;
 524      =2  #define         ISP_TRIG()      ISP_TRIG = 0x5A,        ISP_TRIG = 0xA5         //ISP´¥·¢ÃüÁî
 525      =2  
 526      =2  //                                                        7    6    5      4    3    2    1     0    Reset Value
 527      =2  //sfr IAP_CONTR = 0xC7;         IAPEN SWBS SWRST CFAIL  -   WT2  WT1   WT0   0000,x000  //IAP Control Register
 528      =2  #define ISP_EN                  (1<<7)
 529      =2  #define ISP_SWBS                (1<<6)
 530      =2  #define ISP_SWRST               (1<<5)
 531      =2  #define ISP_CMD_FAIL    (1<<4)
 532      =2  #define ISP_WAIT_1MHZ   7
 533      =2  #define ISP_WAIT_2MHZ   6
 534      =2  #define ISP_WAIT_3MHZ   5
 535      =2  #define ISP_WAIT_6MHZ   4
 536      =2  #define ISP_WAIT_12MHZ  3
 537      =2  #define ISP_WAIT_20MHZ  2
 538      =2  #define ISP_WAIT_24MHZ  1
 539      =2  #define ISP_WAIT_30MHZ  0
 540      =2  
 541      =2  #if (MAIN_Fosc >= 24000000L)
           =2         #define         ISP_WAIT_FREQUENCY      ISP_WAIT_30MHZ
           =2 #elif (MAIN_Fosc >= 20000000L)
           =2         #define         ISP_WAIT_FREQUENCY      ISP_WAIT_24MHZ
           =2 #elif (MAIN_Fosc >= 12000000L)
           =2         #define         ISP_WAIT_FREQUENCY      ISP_WAIT_20MHZ
           =2 #elif (MAIN_Fosc >= 6000000L)
 548      =2          #define         ISP_WAIT_FREQUENCY      ISP_WAIT_12MHZ
 549      =2  #elif (MAIN_Fosc >= 3000000L)
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 12  

           =2         #define         ISP_WAIT_FREQUENCY      ISP_WAIT_6MHZ
           =2 #elif (MAIN_Fosc >= 2000000L)
           =2         #define         ISP_WAIT_FREQUENCY      ISP_WAIT_3MHZ
           =2 #elif (MAIN_Fosc >= 1000000L)
           =2         #define         ISP_WAIT_FREQUENCY      ISP_WAIT_2MHZ
           =2 #else
           =2         #define         ISP_WAIT_FREQUENCY      ISP_WAIT_1MHZ
           =2 #endif
 558      =2  
 559      =2  
 560      =2  
 561      =2  /* ADC Register */
 562      =2  //                                                              7       6      5       4         3      2    1    0   Reset Value
 563      =2  //sfr ADC_CONTR = 0xBC;         ADC_POWER SPEED1 SPEED0 ADC_FLAG ADC_START CHS2 CHS1 CHS0 0000,0000     //AD ×ª»»¿ØÖÆ
             -¼Ä´æÆ÷ 
 564      =2  //sfr ADC_RES  = 0xBD;          ADCV.9 ADCV.8 ADCV.7 ADCV.6 ADCV.5 ADCV.4 ADCV.3 ADCV.2   0000,0000     //A/D ×ª»»½á¹û
             -¸ß8Î» 
 565      =2  //sfr ADC_RESL = 0xBE;                                                                                            ADCV.1 ADCV.0   0000,0000     //A/D ×ª»»½á¹ûµÍ2Î»
 566      =2  //sfr ADC_CONTR  = 0xBC;        //Ö±½ÓÓÃMOV²Ù×÷£¬²»ÒªÓÃÓë»ò
 567      =2  
 568      =2  
 569      =2  //sfr SPCTL  = 0xCE;    SPI¿ØÖÆ¼Ä´æÆ÷
 570      =2  //   7       6       5       4       3       2       1       0          Reset Value
 571      =2  //      SSIG    SPEN    DORD    MSTR    CPOL    CPHA    SPR1    SPR0            0x00
 572      =2  
 573      =2  #define SPI_SSIG_None()         SPCTL |=  (1<<7)                //1: ºöÂÔSS½Å
 574      =2  #define SPI_SSIG_Enable()       SPCTL &= ~(1<<7)                //0: SS½ÅÓÃÓÚ¾ö¶¨Ö÷´Ó»ú
 575      =2  #define SPI_Enable()            SPCTL |=  (1<<6)                //1: ÔÊÐíSPI
 576      =2  #define SPI_Disable()           SPCTL &= ~(1<<6)                //0: ½ûÖ¹SPI
 577      =2  #define SPI_LSB_First()         SPCTL |=  (1<<5)                //1: LSBÏÈ·¢
 578      =2  #define SPI_MSB_First()         SPCTL &= ~(1<<5)                //0: MSBÏÈ·¢
 579      =2  #define SPI_Master()            SPCTL |=  (1<<4)                //1: ÉèÎªÖ÷»ú
 580      =2  #define SPI_Slave()                     SPCTL &= ~(1<<4)                //0: ÉèÎª´Ó»ú
 581      =2  #define SPI_SCLK_NormalH()      SPCTL |=  (1<<3)                //1: ¿ÕÏÐÊ±SCLKÎª¸ßµçÆ½
 582      =2  #define SPI_SCLK_NormalL()      SPCTL &= ~(1<<3)                //0: ¿ÕÏÐÊ±SCLKÎªµÍµçÆ½
 583      =2  #define SPI_PhaseH()            SPCTL |=  (1<<2)                //1: 
 584      =2  #define SPI_PhaseL()            SPCTL &= ~(1<<2)                //0: 
 585      =2  #define SPI_Speed(n)            SPCTL = (SPCTL & ~3) | (n)      //ÉèÖÃËÙ¶È, 0 -- fosc/4, 1 -- fosc/16, 2 -- fosc/64, 3 --
             - fosc/128
 586      =2  
 587      =2  //sfr SPDAT  = 0xCF; //SPI Data Register                                                     0000,0000
 588      =2  //sfr SPSTAT  = 0xCD;   //SPI×´Ì¬¼Ä´æÆ÷
 589      =2  //   7       6      5   4   3   2   1   0       Reset Value
 590      =2  //      SPIF    WCOL    -       -       -       -       -       -
 591      =2  #define SPIF    0x80            //SPI´«ÊäÍê³É±êÖ¾¡£Ð´Èë1Çå0¡£
 592      =2  #define WCOL    0x40            //SPIÐ´³åÍ»±êÖ¾¡£Ð´Èë1Çå0¡£
 593      =2  
 594      =2  #define         SPI_USE_P12P13P14P15()  AUXR1 &= ~0x0c  //½«SPIÇÐ»»µ½P12(SS) P13(MOSI) P14(MISO) P15(SCLK)(ÉÏµçÄ¬ÈÏ
             -)¡£
 595      =2  #define         SPI_USE_P24P23P22P21()  AUXR1 = (AUXR1 & ~0x0c) | 0x04  //½«SPIÇÐ»»µ½P24(SS) P23(MOSI) P22(MISO) P2
             -1(SCLK)¡£
 596      =2  #define         SPI_USE_P54P40P41P43()  AUXR1 = (AUXR1 & ~0x0c) | 0x08  //½«SPIÇÐ»»µ½P54(SS) P40(MOSI) P41(MISO) P4
             -3(SCLK)¡£
 597      =2  
 598      =2  
 599      =2  /*
 600      =2  ;PCA_PWMn:    7       6     5   4   3   2     1       0
 601      =2  ;                       EBSn_1  EBSn_0  -       -       -       -       EPCnH   EPCnL
 602      =2  ;B5-B2:         ±£Áô
 603      =2  ;B1(EPCnH):     ÔÚPWMÄ£Ê½ÏÂ£¬ÓëCCAPnH×é³É9Î»Êý¡£
 604      =2  ;B0(EPCnL):     ÔÚPWMÄ£Ê½ÏÂ£¬ÓëCCAPnL×é³É9Î»Êý¡£
 605      =2  */
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 13  

 606      =2  #define         PWM0_NORMAL()   PCA_PWM0 &= ~3                          //PWM0Õý³£Êä³ö(Ä¬ÈÏ)
 607      =2  #define         PWM0_OUT_0()    PCA_PWM0 |=  3                          //PWM0Ò»Ö±Êä³ö0
 608      =2  #define         PWM0_OUT_1()    PCA_PWM0 &= ~3, CCAP0H = 0      //PWM0Ò»Ö±Êä³ö1
 609      =2  
 610      =2  #define         PWM1_NORMAL()   PCA_PWM1 &= ~3                          //PWM0Õý³£Êä³ö(Ä¬ÈÏ)
 611      =2  #define         PWM1_OUT_0()    PCA_PWM1 |=  3                          //PWM0Ò»Ö±Êä³ö0
 612      =2  #define         PWM1_OUT_1()    PCA_PWM1 &= ~3, CCAP1H = 0      //PWM1Ò»Ö±Êä³ö1
 613      =2  
 614      =2  #define         PWM2_NORMAL()   PCA_PWM2 &= ~3                          //PWM1Õý³£Êä³ö(Ä¬ÈÏ)
 615      =2  #define         PWM2_OUT_0()    PCA_PWM2 |=  3                          //PWM2Ò»Ö±Êä³ö0
 616      =2  #define         PWM2_OUT_1()    PCA_PWM2 &= ~3, CCAP2H = 0      //PWM2Ò»Ö±Êä³ö1
 617      =2  
 618      =2  
 619      =2  //                                              7     6     5     4     3     2     1     0     Reset Value
 620      =2  //sfr CCON   = 0xD8;    CF    CR    -     -     -    CCF2  CCF1  CCF0   00xx,xx00       //PCA ¿ØÖÆ¼Ä´æÆ÷¡£
 621      =2  sbit CCF0  = CCON^0;    //PCA Ä£¿é0ÖÐ¶Ï±êÖ¾£¬ÓÉÓ²¼þÖÃÎ»£¬±ØÐëÓÉÈí¼þÇå0¡£
 622      =2  sbit CCF1  = CCON^1;    //PCA Ä£¿é1ÖÐ¶Ï±êÖ¾£¬ÓÉÓ²¼þÖÃÎ»£¬±ØÐëÓÉÈí¼þÇå0¡£
 623      =2  sbit CCF2  = CCON^2;    //PCA Ä£¿é2ÖÐ¶Ï±êÖ¾£¬ÓÉÓ²¼þÖÃÎ»£¬±ØÐëÓÉÈí¼þÇå0¡£
 624      =2  sbit CR    = CCON^6;    //1: ÔÊÐíPCA¼ÆÊýÆ÷¼ÆÊý£¬±ØÐëÓÉÈí¼þÇå0¡£
 625      =2  sbit CF    = CCON^7;    //PCA¼ÆÊýÆ÷Òç³ö£¨CH£¬CLÓÉFFFFH±äÎª0000H£©±êÖ¾¡£PCA¼ÆÊýÆ÷Òç³öºóÓÉÓ²¼þÖÃÎ»£¬±ØÐëÓÉÈí¼þÇ
             -å0¡£
 626      =2  
 627      =2  //                                       7     6     5     4     3     2     1     0    Reset Value
 628      =2  //sfr CMOD  = 0xD9;     CIDL   -     -     -   CPS2   CPS1  CPS0  ECF   0xxx,0000       //PCA ¹¤×÷Ä£Ê½¼Ä´æÆ÷¡£
 629      =2  #define PCA_IDLE_OFF()          CMOD |=  (1<<7)                         //IDLE×´Ì¬PCAÍ£Ö¹¼ÆÊý¡£
 630      =2  #define PCA_IDLE_ON()           CMOD &= ~(1<<7)                         //IDLE×´Ì¬PCA¼ÌÐø¼ÆÊý¡£
 631      =2  #define PCA_CLK_12T()           CMOD &= ~0x0E                           //PCA¼ÆÊýÂö³åÑ¡ÔñÍâ²¿¾§Õñ/12¡£  fosc/12
 632      =2  #define PCA_CLK_2T()            CMOD = (CMOD & ~0x0E) + 2       //PCA¼ÆÊýÂö³åÑ¡ÔñÍâ²¿¾§Õñ/2¡£   fosc/2
 633      =2  #define PCA_CLK_T0()            CMOD = (CMOD & ~0x0E) + 4       //PCA¼ÆÊýÂö³åÑ¡ÔñTimer0ÖÐ¶Ï£¬Timer0¿ÉÍ¨¹ýAUXR¼Ä´æÆ÷ÉèÖÃ³É¹
             -¤×÷ÔÚ12T»ò1TÄ£Ê½¡£
 634      =2  #define PCA_CLK_ECI()           CMOD = (CMOD & ~0x0E) + 6       //PCA¼ÆÊýÂö³åÑ¡Ôñ´ÓECI/P3.4½ÅÊäÈëµÄÍâ²¿Ê±ÖÓ£¬×î´ó fosc/2¡
             -£
 635      =2  #define PCA_CLK_1T()            CMOD = (CMOD & ~0x0E) + 8       //PCA¼ÆÊýÂö³åÑ¡ÔñÍâ²¿¾§Õñ¡£             Fosc/1
 636      =2  #define PCA_CLK_4T()            CMOD = (CMOD & ~0x0E) + 10      //PCA¼ÆÊýÂö³åÑ¡ÔñÍâ²¿¾§Õñ/4¡£   Fosc/4
 637      =2  #define PCA_CLK_6T()            CMOD = (CMOD & ~0x0E) + 12      //PCA¼ÆÊýÂö³åÑ¡ÔñÍâ²¿¾§Õñ/6¡£   Fosc/6
 638      =2  #define PCA_CLK_8T()            CMOD = (CMOD & ~0x0E) + 14      //PCA¼ÆÊýÂö³åÑ¡ÔñÍâ²¿¾§Õñ/8¡£   Fosc/8
 639      =2  #define PCA_INT_ENABLE()        CMOD |=  1                                      //PCA¼ÆÊýÆ÷Òç³öÖÐ¶ÏÔÊÐíÎ»£¬1---ÔÊÐíCF£¨CCON.7£©²úÉúÖÐ¶Ï¡£
 640      =2  #define PCA_INT_DISABLE()       CMOD &= ~1                                      //PCA¼ÆÊýÆ÷Òç³öÖÐ¶Ï½ûÖ¹¡£
 641      =2  
 642      =2  //                                          7      6       5        4       3       2       1      0    Reset Value
 643      =2  //sfr AUXR1 = 0xA2;       S1_S1  S1_S0  CCP_S1   CCP_S0  SPI_S1   SPI_S0    -     DPS   0100,0000       //Auxiliary 
             -Register 1
 644      =2  
 645      =2  #define         PCA_USE_P12P11P10P37()  AUXR1 &= ~0x30          //½«PCA/PWMÇÐ»»µ½P12(ECI) P11(CCP0) P10(CCP1) P37(CCP2)(ÉÏ
             -µçÄ¬ÈÏ)¡£
 646      =2  #define         PCA_USE_P34P35P36P37()  AUXR1 = (AUXR1 & ~0x30) | 0x10  //½«PCA/PWMÇÐ»»µ½P34(ECI) P35(CCP0) P36(CCP
             -1) P37(CCP2)¡£
 647      =2  #define         PCA_USE_P24P25P26P27()  AUXR1 = (AUXR1 & ~0x30) | 0x20  //½«PCA/PWMÇÐ»»µ½P24(ECI) P25(CCP0) P26(CCP
             -1) P27(CCP2)¡£
 648      =2  
 649      =2  #define         DPS_SEL1()              AUXR1 |=  1             //1£ºÑ¡ÔñDPTR1¡£
 650      =2  #define         DPS_SEL0()              AUXR1 &= ~1             //0£ºÑ¡ÔñDPTR0(ÉÏµçÄ¬ÈÏ)¡£
 651      =2  
 652      =2  
 653      =2  /*                                                                      7     6      5      4     3     2     1     0     Reset Value
 654      =2  //sfr CCAPM0 = 0xDA;    PWM ¼Ä´æÆ÷  -   ECOM0  CAPP0  CAPN0  MAT0  TOG0  PWM0  ECCF0   x000,0000        //PCA Ä£¿é0 
 655      =2  //sfr CCAPM1 = 0xDB;    PWM ¼Ä´æÆ÷  -   ECOM1  CAPP1  CAPN1  MAT1  TOG1  PWM1  ECCF1   x000,0000        //PCA Ä£¿é1
 656      =2  //sfr CCAPM2 = 0xDC;    PWM ¼Ä´æÆ÷  -   ECOM2  CAPP2  CAPN2  MAT2  TOG2  PWM2  ECCF2   x000,0000        //PCA Ä£¿é2
 657      =2  ;ECOMn = 1:     ÔÊÐí±È½Ï¹¦ÄÜ¡£
 658      =2  ;CAPPn = 1:     ÔÊÐíÉÏÉýÑØ´¥·¢²¶×½¹¦ÄÜ¡£
 659      =2  ;CAPNn = 1:     ÔÊÐíÏÂ½µÑØ´¥·¢²¶×½¹¦ÄÜ¡£
 660      =2  ;MATn  = 1:     µ±Æ¥ÅäÇé¿ö·¢ÉúÊ±£¬ÔÊÐíCCONÖÐµÄCCFnÖÃÎ»¡£
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 14  

 661      =2  ;TOGn  = 1:     µ±Æ¥ÅäÇé¿ö·¢ÉúÊ±£¬CEXn½«·­×ª¡£(CEX0/PCA0/PWM0/P3.7,CEX1/PCA1/PWM1/P3.5)
 662      =2  ;PWMn  = 1:     ½«CEXnÉèÖÃÎªPWMÊä³ö¡£
 663      =2  ;ECCFn = 1:     ÔÊÐíCCONÖÐµÄCCFn´¥·¢ÖÐ¶Ï¡£
 664      =2  ;ECOMn CAPPn CAPNn MATn TOGn PWMn ECCFn
 665      =2  ;  0     0     0    0    0    0     0           00H     Î´ÆôÓÃÈÎºÎ¹¦ÄÜ¡£
 666      =2  ;  x     1     0    0    0    0     x           20H     16Î»CEXnÉÏÉýÑØ´¥·¢²¶×½¹¦ÄÜ¡£
 667      =2  ;  x     0     1    0    0    0     x           10H     16Î»CEXnÏÂ½µÑØ´¥·¢²¶×½¹¦ÄÜ¡£
 668      =2  ;  x     1     1    0    0    0     x           30H     16Î»CEXn/PCAn±ßÑØ£¨ÉÏ¡¢ÏÂÑØ£©´¥·¢²¶×½¹¦ÄÜ¡£
 669      =2  ;  1     0     0    1    0    0     x           48H     16Î»Èí¼þ¶¨Ê±Æ÷¡£
 670      =2  ;  1     0     0    1    1    0     x           4CH     16Î»¸ßËÙÂö³åÊä³ö¡£
 671      =2  ;  1     0     0    0    0    1     0           42H     8Î»PWM¡£ÎÞÖÐ¶Ï
 672      =2  ;  1     1     0    0    0    1     1           63H     8Î»PWM¡£µÍ±ä¸ß¿É²úÉúÖÐ¶Ï
 673      =2  ;  1     0     1    0    0    1     1           53H     8Î»PWM¡£¸ß±äµÍ¿É²úÉúÖÐ¶Ï
 674      =2  ;  1     1     1    0    0    1     1           73H     8Î»PWM¡£µÍ±ä¸ß»ò¸ß±äµÍ¾ù¿É²úÉúÖÐ¶Ï
 675      =2  ;*******************************************************************
 676      =2  ;*******************************************************************/
 677      =2  #define         PCA0_none()                             CCAPM0 = 0
 678      =2  #define         PCA0_PWM(nbit)                  CCAPM0 = 0x42,PCA_PWM0 = (PCA_PWM0 & 0x0c) | ((8-nbit)<<6)
 679      =2  #define         PCA0_PWM_rise_int(nbit) CCAPM0 = 0x63,PCA_PWM0 = (PCA_PWM0 & 0x0c) | ((8-nbit)<<6)
 680      =2  #define         PCA0_PWM_fall_int(nbit) CCAPM0 = 0x53,PCA_PWM0 = (PCA_PWM0 & 0x0c) | ((8-nbit)<<6)
 681      =2  #define         PCA0_PWM_edge_int(nbit) CCAPM0 = 0x73,PCA_PWM0 = (PCA_PWM0 & 0x0c) | ((8-nbit)<<6)
 682      =2  #define         PCA0_capture_rise()             CCAPM0 = (0x20 + 1)
 683      =2  #define         PCA0_capture_fall()             CCAPM0 = (0x10 + 1)
 684      =2  #define         PCA0_capture_edge()             CCAPM0 = (0x30 + 1)
 685      =2  #define         PCA0_16bit_Timer()              CCAPM0 = (0x48 + 1)
 686      =2  #define         PCA0_High_Pulse()               CCAPM0 = (0x4C + 1)
 687      =2  
 688      =2  #define         PCA1_none()                             CCAPM1 = 0
 689      =2  #define         PCA1_PWM(nbit)                  CCAPM1 = 0x42,PCA_PWM1 = (PCA_PWM1 & 0x0c) | ((8-nbit)<<6)
 690      =2  #define         PCA1_PWM_rise_int(nbit) CCAPM1 = 0x63,PCA_PWM1 = (PCA_PWM1 & 0x0c) | ((8-nbit)<<6)
 691      =2  #define         PCA1_PWM_fall_int(nbit) CCAPM1 = 0x53,PCA_PWM1 = (PCA_PWM1 & 0x0c) | ((8-nbit)<<6)
 692      =2  #define         PCA1_PWM_edge_int(nbit) CCAPM1 = 0x73,PCA_PWM1 = (PCA_PWM1 & 0x0c) | ((8-nbit)<<6)
 693      =2  #define         PCA1_capture_rise()             CCAPM1 = (0x20 + 1)
 694      =2  #define         PCA1_capture_fall()             CCAPM1 = (0x10 + 1)
 695      =2  #define         PCA1_capture_edge()             CCAPM1 = (0x30 + 1)
 696      =2  #define         PCA1_16bit_Timer()              CCAPM1 = (0x48 + 1)
 697      =2  #define         PCA1_High_Pulse()               CCAPM1 = (0x4C + 1)
 698      =2  
 699      =2  #define         PCA2_none()                             CCAPM2 = 0
 700      =2  #define         PCA2_PWM(nbit)                  CCAPM2 = 0x42,PCA_PWM2 = (PCA_PWM2 & 0x0c) | ((8-nbit)<<6)
 701      =2  #define         PCA2_PWM_rise_int(nbit) CCAPM2 = 0x63,PCA_PWM2 = (PCA_PWM2 & 0x0c) | ((8-nbit)<<6)
 702      =2  #define         PCA2_PWM_fall_int(nbit) CCAPM2 = 0x53,PCA_PWM2 = (PCA_PWM2 & 0x0c) | ((8-nbit)<<6)
 703      =2  #define         PCA2_PWM_edge_int(nbit) CCAPM2 = 0x73,PCA_PWM2 = (PCA_PWM2 & 0x0c) | ((8-nbit)<<6)
 704      =2  #define         PCA2_capture_rise()             CCAPM2 = (0x20 + 1)
 705      =2  #define         PCA2_capture_fall()             CCAPM2 = (0x10 + 1)
 706      =2  #define         PCA2_capture_edge()             CCAPM2 = (0x30 + 1)
 707      =2  #define         PCA2_16bit_Timer()              CCAPM2 = (0x48 + 1)
 708      =2  #define         PCA2_High_Pulse()               CCAPM2 = (0x4C + 1)
 709      =2  
 710      =2  /* Above is STC additional SFR or change */
 711      =2  
 712      =2  
 713      =2  
 714      =2  
 715      =2  /**********************************************************/
 716      =2  typedef         unsigned char   u8;
 717      =2  typedef         unsigned int    u16;
 718      =2  typedef         unsigned long   u32;
 719      =2  
 720      =2  /**********************************************************/
 721      =2  #define NOP1()  _nop_()
 722      =2  #define NOP2()  NOP1(),NOP1()
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 15  

 723      =2  #define NOP3()  NOP2(),NOP1()
 724      =2  #define NOP4()  NOP3(),NOP1()
 725      =2  #define NOP5()  NOP4(),NOP1()
 726      =2  #define NOP6()  NOP5(),NOP1()
 727      =2  #define NOP7()  NOP6(),NOP1()
 728      =2  #define NOP8()  NOP7(),NOP1()
 729      =2  #define NOP9()  NOP8(),NOP1()
 730      =2  #define NOP10() NOP9(),NOP1()
 731      =2  #define NOP11() NOP10(),NOP1()
 732      =2  #define NOP12() NOP11(),NOP1()
 733      =2  #define NOP13() NOP12(),NOP1()
 734      =2  #define NOP14() NOP13(),NOP1()
 735      =2  #define NOP15() NOP14(),NOP1()
 736      =2  #define NOP16() NOP15(),NOP1()
 737      =2  #define NOP17() NOP16(),NOP1()
 738      =2  #define NOP18() NOP17(),NOP1()
 739      =2  #define NOP19() NOP18(),NOP1()
 740      =2  #define NOP20() NOP19(),NOP1()
 741      =2  #define NOP21() NOP20(),NOP1()
 742      =2  #define NOP22() NOP21(),NOP1()
 743      =2  #define NOP23() NOP22(),NOP1()
 744      =2  #define NOP24() NOP23(),NOP1()
 745      =2  #define NOP25() NOP24(),NOP1()
 746      =2  #define NOP26() NOP25(),NOP1()
 747      =2  #define NOP27() NOP26(),NOP1()
 748      =2  #define NOP28() NOP27(),NOP1()
 749      =2  #define NOP29() NOP28(),NOP1()
 750      =2  #define NOP30() NOP29(),NOP1()
 751      =2  #define NOP31() NOP30(),NOP1()
 752      =2  #define NOP32() NOP31(),NOP1()
 753      =2  #define NOP33() NOP32(),NOP1()
 754      =2  #define NOP34() NOP33(),NOP1()
 755      =2  #define NOP35() NOP34(),NOP1()
 756      =2  #define NOP36() NOP35(),NOP1()
 757      =2  #define NOP37() NOP36(),NOP1()
 758      =2  #define NOP38() NOP37(),NOP1()
 759      =2  #define NOP39() NOP38(),NOP1()
 760      =2  #define NOP40() NOP39(),NOP1()
 761      =2  #define NOP(N)  NOP##N()
 762      =2  
 763      =2  
 764      =2  /**********************************************/
 765      =2  
 766      =2  
 767      =2  /****************************************************************/
 768      =2  
 769      =2  
 770      =2  //sfr INT_CLKO = 0x8F;  //¸½¼ÓµÄ SFR WAKE_CLKO (µØÖ·£º0x8F)
 771      =2  /*
 772      =2      7   6    5    4   3     2        1       0         Reset Value
 773      =2      -  EX4  EX3  EX2  -   T2CLKO   T1CLKO  T0CLKO      0000,0000B
 774      =2  b6 -  EX4      : ÍâÖÐ¶ÏINT4ÔÊÐí
 775      =2  b5 -  EX3      : ÍâÖÐ¶ÏINT3ÔÊÐí
 776      =2  b4 -  EX2      : ÍâÖÐ¶ÏINT2ÔÊÐí
 777      =2  b2 - T1CLKO    : ÔÊÐí T2 Òç³öÂö³åÔÚP3.0½ÅÊä³ö£¬Fck1 = 1/2 T1 Òç³öÂÊ
 778      =2  b1 - T1CLKO    : ÔÊÐí T1 Òç³öÂö³åÔÚP3.4½ÅÊä³ö£¬Fck1 = 1/2 T1 Òç³öÂÊ
 779      =2  b0 - T0CLKO    : ÔÊÐí T0 Òç³öÂö³åÔÚP3.5½ÅÊä³ö£¬Fck0 = 1/2 T0 Òç³öÂÊ
 780      =2  */
 781      =2  
 782      =2  #define         LVD_InterruptEnable()           ELVD = 1
 783      =2  #define         LVD_InterruptDisable()          ELVD = 0
 784      =2  
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 16  

 785      =2  
 786      =2  //sfr WKTCL = 0xAA;     //STC11F\10ºÍSTC15ÏµÁÐ »½ÐÑ¶¨Ê±Æ÷µÍ×Ö½Ú
 787      =2  //sfr WKTCH = 0xAB;     //STC11F\10ºÍSTC15ÏµÁÐ »½ÐÑ¶¨Ê±Æ÷¸ß×Ö½Ú
 788      =2  //      B7              B6      B5      B4      B3      B2      B1      B0              B7      B6      B5      B4      B3      B2      B1      B0
 789      =2  //      WKTEN                           S11     S10     S9      S8              S7      S6      S5      S4      S3      S2      S1      S0      n * 560us
 790      =2  #define         WakeTimerDisable()              WKTCH &= 0x7f   //WKTEN = 0             ½ûÖ¹Ë¯Ãß»½ÐÑ¶¨Ê±Æ÷
 791      =2  #define         WakeTimerSet(scale)             WKTCL = (scale) % 256,WKTCH = (scale) / 256 | 0x80      //WKTEN = 1     ÔÊÐíË¯Ãß»½ÐÑ¶
             -¨Ê±Æ÷
 792      =2  
 793      =2  
 794      =2  //sfr CLK_DIV = 0x97; //Clock Divder ÏµÍ³Ê±ÖÓ·ÖÆµ  -     -      -       -     -  CLKS2 CLKS1 CLKS0 xxxx,x0
             -00
 795      =2  #define         SYSTEM_CLK_1T()         CLK_DIV &= ~0x07        //default
 796      =2  #define         SYSTEM_CLK_2T()         CLK_DIV = (CLK_DIV & ~0x07) | 1
 797      =2  #define         SYSTEM_CLK_4T()         CLK_DIV = (CLK_DIV & ~0x07) | 2
 798      =2  #define         SYSTEM_CLK_8T()         CLK_DIV = (CLK_DIV & ~0x07) | 3
 799      =2  #define         SYSTEM_CLK_16T()        CLK_DIV = (CLK_DIV & ~0x07) | 4
 800      =2  #define         SYSTEM_CLK_32T()        CLK_DIV = (CLK_DIV & ~0x07) | 5
 801      =2  #define         SYSTEM_CLK_64T()        CLK_DIV = (CLK_DIV & ~0x07) | 6
 802      =2  #define         SYSTEM_CLK_128T()       CLK_DIV =  CLK_DIV          | 7
 803      =2  
 804      =2  #define         MCLKO_P54_None()        CLK_DIV &= ~0xc0                                        //Ö÷Ê±ÖÓ²»Êä³ö
 805      =2  #define         MCLKO_P54_DIV1()        CLK_DIV  = (CLK_DIV & ~0xc0) | 0x40     //Ö÷Ê±ÖÓ²»·ÖÆµÊä³ö
 806      =2  #define         MCLKO_P54_DIV2()        CLK_DIV  = (CLK_DIV & ~0xc0) | 0x80     //Ö÷Ê±ÖÓ2·ÖÆµÊä³ö
 807      =2  #define         MCLKO_P54_DIV4()        CLK_DIV  =  CLK_DIV | 0xc0                      //Ö÷Ê±ÖÓ4·ÖÆµÊä³ö
 808      =2  
 809      =2  #define         MCLKO_P34_None()        CLK_DIV &= ~0xc0                                        //Ö÷Ê±ÖÓ²»Êä³ö
 810      =2  #define         MCLKO_P34_DIV1()        CLK_DIV  = (CLK_DIV & ~0xc0) | 0x40     //Ö÷Ê±ÖÓ²»·ÖÆµÊä³ö
 811      =2  #define         MCLKO_P34_DIV2()        CLK_DIV  = (CLK_DIV & ~0xc0) | 0x80     //Ö÷Ê±ÖÓ2·ÖÆµÊä³ö
 812      =2  #define         MCLKO_P34_DIV4()        CLK_DIV  =  CLK_DIV | 0xc0                      //Ö÷Ê±ÖÓ4·ÖÆµÊä³ö
 813      =2  
 814      =2  //sfr BUS_SPEED = 0xA1; //Stretch register      -   -  -  -   -   -  EXRTS1  EXRTSS0 xxxx,xx10
 815      =2  #define         BUS_SPEED_1T()  BUS_SPEED = 0
 816      =2  #define         BUS_SPEED_2T()  BUS_SPEED = 1
 817      =2  #define         BUS_SPEED_4T()  BUS_SPEED = 2
 818      =2  #define         BUS_SPEED_8T()  BUS_SPEED = 3
 819      =2  
 820      =2  /*   interrupt vector */
 821      =2  #define         INT0_VECTOR             0
 822      =2  #define         TIMER0_VECTOR   1
 823      =2  #define         INT1_VECTOR             2
 824      =2  #define         TIMER1_VECTOR   3
 825      =2  #define         UART1_VECTOR    4
 826      =2  #define         ADC_VECTOR              5
 827      =2  #define         LVD_VECTOR              6
 828      =2  #define         PCA_VECTOR              7
 829      =2  #define         UART2_VECTOR    8
 830      =2  #define         SPI_VECTOR              9
 831      =2  #define         INT2_VECTOR             10
 832      =2  #define         INT3_VECTOR             11
 833      =2  #define         TIMER2_VECTOR   12
 834      =2  #define         INT4_VECTOR             16
 835      =2  #define         UART3_VECTOR    17
 836      =2  #define         UART4_VECTOR    18
 837      =2  #define         TIMER3_VECTOR   19
 838      =2  #define         TIMER4_VECTOR   20
 839      =2  #define         CMP_VECTOR              21
 840      =2  
 841      =2  
 842      =2  #define TRUE    1
 843      =2  #define FALSE   0
 844      =2  
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 17  

 845      =2  //=============================================================
 846      =2  
 847      =2  //========================================
 848      =2  
 849      =2  #define PolityLow                       0       //µÍÓÅÏÈ¼¶ÖÐ¶Ï
 850      =2  #define PolityHigh                      1       //¸ßÓÅÏÈ¼¶ÖÐ¶Ï
 851      =2  
 852      =2  //========================================
 853      =2  
 854      =2  #define         MCLKO_None      0
 855      =2  #define         MCLKO_DIV1      1
 856      =2  #define         MCLKO_DIV2      2
 857      =2  #define         MCLKO_DIV4      3
 858      =2  
 859      =2  #define         ENABLE          1
 860      =2  #define         DISABLE         0
 861      =2  
 862      =2  #define         STC15F_L2K08S2  8
 863      =2  #define         STC15F_L2K16S2  16
 864      =2  #define         STC15F_L2K24S2  24
 865      =2  #define         STC15F_L2K32S2  32
 866      =2  #define         STC15F_L2K40S2  40
 867      =2  #define         STC15F_L2K48S2  48
 868      =2  #define         STC15F_L2K56S2  56
 869      =2  #define         STC15F_L2K60S2  60
 870      =2  #define         IAP15F_L2K61S2  61
 871      =2  
 872      =2  #endif
   1      =2  /*--------------------------------------------------------------------------
   2      =2  STDLIB.H
   3      =2  
   4      =2  Standard functions.
   5      =2  Copyright (c) 1988-2005 Keil Elektronik GmbH and Keil Software, Inc.
   6      =2  All rights reserved.
   7      =2  --------------------------------------------------------------------------*/
   8      =2  
   9      =2  #ifndef __STDLIB_H__
  10      =2  #define __STDLIB_H__
  11      =2  
  12      =2  #ifndef _SIZE_T
  13      =2   #define _SIZE_T
  14      =2   typedef unsigned int size_t;
  15      =2  #endif
  16      =2  
  17      =2  #ifndef NULL
  18      =2   #define NULL ((void *) 0L)
  19      =2  #endif
  20      =2  
  21      =2  #ifndef _WCHAR_T_DEFINED_
  22      =2  #define _WCHAR_T_DEFINED_
  23      =2  typedef char wchar_t;
  24      =2  #endif
  25      =2  
  26      =2  #ifndef RAND_MAX
  27      =2   #define RAND_MAX  32767u
  28      =2  #endif
  29      =2  
  30      =2  #pragma SAVE
  31      =2  #pragma REGPARMS
  32      =2  
  33      =2  extern int    abs  (int   val);
  34      =2  extern long  labs  (long  val);
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 18  

  35      =2  
  36      =2  extern float atof (char *s1);
  37      =2  extern long  atol (char *s1);
  38      =2  extern int   atoi (char *s1);
  39      =2  extern int   rand ();
  40      =2  extern void  srand (int);
  41      =2  
  42      =2  extern float         strtod  (char *, char **);
  43      =2  extern long          strtol  (char *, char **, unsigned char);
  44      =2  extern unsigned long strtoul (char *, char **, unsigned char);
  45      =2  
  46      =2  #define _MALLOC_MEM_    xdata
  47      =2  
  48      =2  extern void init_mempool          (void _MALLOC_MEM_ *p, unsigned int size);
  49      =2  extern void _MALLOC_MEM_ *malloc  (unsigned int size);
  50      =2  extern void free                  (void _MALLOC_MEM_ *p);
  51      =2  extern void _MALLOC_MEM_ *realloc (void _MALLOC_MEM_ *p, unsigned int size);
  52      =2  extern void _MALLOC_MEM_ *calloc  (unsigned int size, unsigned int len);
  53      =2  
  54      =2  #pragma RESTORE
  55      =2  
  56      =2  #endif
   1      =2  /*--------------------------------------------------------------------------
   2      =2  STDIO.H
   3      =2  
   4      =2  Prototypes for standard I/O functions.
   5      =2  Copyright (c) 1988-2002 Keil Elektronik GmbH and Keil Software, Inc.
   6      =2  All rights reserved.
   7      =2  --------------------------------------------------------------------------*/
   8      =2  
   9      =2  #ifndef __STDIO_H__
  10      =2  #define __STDIO_H__
  11      =2  
  12      =2  #ifndef EOF
  13      =2   #define EOF -1
  14      =2  #endif
  15      =2  
  16      =2  #ifndef NULL
           =2  #define NULL ((void *) 0)
           =2 #endif
  19      =2  
  20      =2  #ifndef _SIZE_T
           =2  #define _SIZE_T
           =2  typedef unsigned int size_t;
           =2 #endif
  24      =2  
  25      =2  #pragma SAVE
  26      =2  #pragma REGPARMS
  27      =2  extern char _getkey (void);
  28      =2  extern char getchar (void);
  29      =2  extern char ungetchar (char);
  30      =2  extern char putchar (char);
  31      =2  extern int printf   (const char *, ...);
  32      =2  extern int sprintf  (char *, const char *, ...);
  33      =2  extern int vprintf  (const char *, char *);
  34      =2  extern int vsprintf (char *, const char *, char *);
  35      =2  extern char *gets (char *, int n);
  36      =2  extern int scanf (const char *, ...);
  37      =2  extern int sscanf (char *, const char *, ...);
  38      =2  extern int puts (const char *);
  39      =2  
  40      =2  #pragma RESTORE
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 19  

  41      =2  
  42      =2  #endif
  43      =2  
   1      =2  #ifndef __STDINT_H__
   2      =2  #define __STDINT_H__
   3      =2  
   4      =2  typedef unsigned char uint8_t;  //1Î»³¤¶È
   5      =2  typedef signed char int8_t;               //
   6      =2  typedef unsigned short uint16_t;  //2Î»³¤¶È
   7      =2  typedef signed short int16_t;
   8      =2  typedef unsigned long uint32_t;   //4Î»³¤¶È
   9      =2  typedef signed long int32_t;
  10      =2  
  11      =2  #endif
   2          #include "USART1.h"
   1      =1  
   2      =1  /*------------------------------------------------------------------*/
   3      =1  /* --- STC MCU International Limited -------------------------------*/
   4      =1  /* --- STC 1T Series MCU RC Demo -----------------------------------*/
   5      =1  /* --- Mobile: (86)13922805190 -------------------------------------*/
   6      =1  /* --- Fax: 86-0513-55012956,55012947,55012969 ---------------------*/
   7      =1  /* --- Tel: 86-0513-55012928,55012929,55012966 ---------------------*/
   8      =1  /* --- Web: www.GXWMCU.com -----------------------------------------*/
   9      =1  /* --- QQ:  800003751 ----------------------------------------------*/
  10      =1  /* If you want to use the program or the program referenced in the  */
  11      =1  /* article, please specify in which data and procedures from STC    */
  12      =1  /*------------------------------------------------------------------*/
  13      =1  
  14      =1  
  15      =1  #ifndef __USART_H
  16      =1  #define __USART_H        
  17      =1  
  18      =1  #include        "config.h"
   1      =2  
   2      =2  #ifndef         __CONFIG_H
           =2 #define         __CONFIG_H
           =2 
           =2 #include        "rtx51tny.h"
           =2 
           =2 /*********************************************************/
           =2 
           =2 //#define MAIN_Fosc             22118400L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 //#define MAIN_Fosc             12000000L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 #define MAIN_Fosc               11059200L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 //#define MAIN_Fosc              5529600L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 //#define MAIN_Fosc             24000000L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 typedef  unsigned int uint;
           =2 typedef  unsigned char uchar;
           =2 
           =2 /*********************************************************/
           =2 #include        "STC15Fxxxx.H"
           =2 
           =2 
           =2 #include "stdlib.h"
           =2 #include <stdio.h>
           =2 #include <stdint.h>
           =2 
           =2 #endif
  19      =1  
  20      =1  #define COM_TX1_Lenth   128
  21      =1  #define COM_RX1_Lenth   128
  22      =1  #define COM_TX2_Lenth   128
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 20  

  23      =1  #define COM_RX2_Lenth   128
  24      =1  
  25      =1  #define USART1  1
  26      =1  #define USART2  2
  27      =1  
  28      =1  #define UART_ShiftRight 0               //Í¬²½ÒÆÎ»Êä³ö
  29      =1  #define UART_8bit_BRTx  (1<<6)  //8Î»Êý¾Ý,¿É±ä²¨ÌØÂÊ
  30      =1  #define UART_9bit               (2<<6)  //9Î»Êý¾Ý,¹Ì¶¨²¨ÌØÂÊ
  31      =1  #define UART_9bit_BRTx  (3<<6)  //9Î»Êý¾Ý,¿É±ä²¨ÌØÂÊ
  32      =1  
  33      =1  #define UART1_SW_P30_P31        0
  34      =1  #define UART1_SW_P36_P37        (1<<6)
  35      =1  #define UART1_SW_P16_P17        (2<<6)  //±ØÐëÊ¹ÓÃÄÚ²¿Ê±ÖÓ
  36      =1  #define UART2_SW_P10_P11        0
  37      =1  #define UART2_SW_P46_P47        1
  38      =1  
  39      =1  
  40      =1  #define TimeOutSet1             5
  41      =1  #define TimeOutSet2             5
  42      =1  
  43      =1  #define BRT_Timer1      1
  44      =1  #define BRT_Timer2      2
  45      =1  
  46      =1  typedef struct
  47      =1  { 
  48      =1          u8      id;                             //´®¿ÚºÅ
  49      =1  
  50      =1          u8      TX_read;                //·¢ËÍ¶ÁÖ¸Õë
  51      =1          u8      TX_write;               //·¢ËÍÐ´Ö¸Õë
  52      =1          u8      B_TX_busy;              //Ã¦±êÖ¾
  53      =1  
  54      =1          u8      RX_Cnt;                 //½ÓÊÕ×Ö½Ú¼ÆÊý
  55      =1          u8      RX_TimeOut;             //½ÓÊÕ³¬Ê±
  56      =1          u8      B_RX_OK;                //½ÓÊÕ¿éÍê³É
  57      =1  } COMx_Define; 
  58      =1  
  59      =1  typedef struct
  60      =1  { 
  61      =1          u8      UART_Mode;                      //Ä£Ê½,         UART_ShiftRight,UART_8bit_BRTx,UART_9bit,UART_9bit_BRTx
  62      =1          u8      UART_BRT_Use;           //Ê¹ÓÃ²¨ÌØÂÊ,   BRT_Timer1,BRT_Timer2
  63      =1          u32     UART_BaudRate;          //²¨ÌØÂÊ,       ENABLE,DISABLE
  64      =1          u8      Morecommunicate;        //¶à»úÍ¨Ñ¶ÔÊÐí, ENABLE,DISABLE
  65      =1          u8      UART_RxEnable;          //ÔÊÐí½ÓÊÕ,   ENABLE,DISABLE
  66      =1          u8      BaudRateDouble;         //²¨ÌØÂÊ¼Ó±¶, ENABLE,DISABLE
  67      =1          u8      UART_Interrupt;         //ÖÐ¶Ï¿ØÖÆ,   ENABLE,DISABLE
  68      =1          u8      UART_Polity;            //ÓÅÏÈ¼¶,     PolityLow,PolityHigh
  69      =1          u8      UART_P_SW;                      //ÇÐ»»¶Ë¿Ú,   UART1_SW_P30_P31,UART1_SW_P36_P37,UART1_SW_P16_P17(±ØÐëÊ¹ÓÃÄÚ²¿Ê±ÖÓ)
  70      =1          u8      UART_RXD_TXD_Short;     //ÄÚ²¿¶ÌÂ·RXDÓëTXD, ×öÖÐ¼Ì, ENABLE,DISABLE
  71      =1  
  72      =1  } COMx_InitDefine; 
  73      =1  
  74      =1  extern volatile COMx_Define     COM1,COM2;
  75      =1  extern  u8      xdata TX1_Buffer[COM_TX1_Lenth];        //·¢ËÍ»º³å
  76      =1  extern  u8      xdata RX1_Buffer[COM_RX1_Lenth];        //½ÓÊÕ»º³å
  77      =1  extern  u8      xdata TX2_Buffer[COM_TX2_Lenth];        //·¢ËÍ»º³å
  78      =1  extern  u8      xdata RX2_Buffer[COM_RX2_Lenth];        //½ÓÊÕ»º³å
  79      =1  extern volatile uint8_t uart1_cmd;
  80      =1  extern volatile uint16_t uart1_cnt;
  81      =1  extern volatile uint8_t config_mode;
  82      =1  
  83      =1  u8      USART_Configuration(u8 UARTx, COMx_InitDefine *COMx);
  84      =1  void TX1_write2buff(u8 dat);    //Ð´Èë·¢ËÍ»º³å£¬Ö¸Õë+1
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 21  

  85      =1  void TX2_write2buff(u8 dat);    //Ð´Èë·¢ËÍ»º³å£¬Ö¸Õë+1
  86      =1  void PrintString1(u8 *puts);
  87      =1  void PrintString2(u8 *puts);
  88      =1  void Printf1(u8 *puts, u8 len);
  89      =1  
  90      =1  //void COMx_write2buff(COMx_Define *COMx, u8 dat);      //Ð´Èë·¢ËÍ»º³å£¬Ö¸Õë+1
  91      =1  void Printf1(u8 *puts, u8 len);
  92      =1  void Printf2(u8 *puts, u8 len);
  93      =1  #endif
  94      =1  
   3          #include "delay.h"
   1      =1  /*------------------------------------------------------------------*/
   2      =1  /* --- STC MCU International Limited -------------------------------*/
   3      =1  /* --- STC 1T Series MCU RC Demo -----------------------------------*/
   4      =1  /* --- Mobile: (86)13922805190 -------------------------------------*/
   5      =1  /* --- Fax: 86-0513-55012956,55012947,55012969 ---------------------*/
   6      =1  /* --- Tel: 86-0513-55012928,55012929,55012966 ---------------------*/
   7      =1  /* --- Web: www.GXWMCU.com -----------------------------------------*/
   8      =1  /* --- QQ:  800003751 ----------------------------------------------*/
   9      =1  /* If you want to use the program or the program referenced in the  */
  10      =1  /* article, please specify in which data and procedures from STC    */
  11      =1  /*------------------------------------------------------------------*/
  12      =1  
  13      =1  
  14      =1  #ifndef __DELAY_H
  15      =1  #define __DELAY_H
  16      =1  
  17      =1  void  delay_ms(unsigned int ms);
  18      =1  void Delay1000ms();             //@11.0592MHz
  19      =1  #endif
   4          #include "GPIO.h"
   1      =1  
   2      =1  /*------------------------------------------------------------------*/
   3      =1  /* --- STC MCU International Limited -------------------------------*/
   4      =1  /* --- STC 1T Series MCU RC Demo -----------------------------------*/
   5      =1  /* --- Mobile: (86)13922805190 -------------------------------------*/
   6      =1  /* --- Fax: 86-0513-55012956,55012947,55012969 ---------------------*/
   7      =1  /* --- Tel: 86-0513-55012928,55012929,55012966 ---------------------*/
   8      =1  /* --- Web: www.GXWMCU.com -----------------------------------------*/
   9      =1  /* --- QQ:  800003751 ----------------------------------------------*/
  10      =1  /* If you want to use the program or the program referenced in the  */
  11      =1  /* article, please specify in which data and procedures from STC    */
  12      =1  /*------------------------------------------------------------------*/
  13      =1  
  14      =1  
  15      =1  #ifndef __GPIO_H
  16      =1  #define __GPIO_H
  17      =1  
  18      =1  #include        "config.h"
   1      =2  
   2      =2  #ifndef         __CONFIG_H
           =2 #define         __CONFIG_H
           =2 
           =2 #include        "rtx51tny.h"
           =2 
           =2 /*********************************************************/
           =2 
           =2 //#define MAIN_Fosc             22118400L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 //#define MAIN_Fosc             12000000L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 #define MAIN_Fosc               11059200L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 //#define MAIN_Fosc              5529600L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 //#define MAIN_Fosc             24000000L       //¶¨ÒåÖ÷Ê±ÖÓ
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 22  

           =2 typedef  unsigned int uint;
           =2 typedef  unsigned char uchar;
           =2 
           =2 /*********************************************************/
           =2 #include        "STC15Fxxxx.H"
           =2 
           =2 
           =2 #include "stdlib.h"
           =2 #include <stdio.h>
           =2 #include <stdint.h>
           =2 
           =2 #endif
  19      =1  
  20      =1  #define GPIO_PullUp             0       //ÉÏÀ­×¼Ë«Ïò¿Ú
  21      =1  #define GPIO_HighZ              1       //¸¡¿ÕÊäÈë
  22      =1  #define GPIO_OUT_OD             2       //¿ªÂ©Êä³ö
  23      =1  #define GPIO_OUT_PP             3       //ÍÆÍìÊä³ö
  24      =1  
  25      =1  #define GPIO_Pin_0              0x01    //IOÒý½Å Px.0
  26      =1  #define GPIO_Pin_1              0x02    //IOÒý½Å Px.1
  27      =1  #define GPIO_Pin_2              0x04    //IOÒý½Å Px.2
  28      =1  #define GPIO_Pin_3              0x08    //IOÒý½Å Px.3
  29      =1  #define GPIO_Pin_4              0x10    //IOÒý½Å Px.4
  30      =1  #define GPIO_Pin_5              0x20    //IOÒý½Å Px.5
  31      =1  #define GPIO_Pin_6              0x40    //IOÒý½Å Px.6
  32      =1  #define GPIO_Pin_7              0x80    //IOÒý½Å Px.7
  33      =1  #define GPIO_Pin_All    0xFF    //IOËùÓÐÒý½Å
  34      =1          
  35      =1  #define GPIO_P0                 0               //
  36      =1  #define GPIO_P1                 1
  37      =1  #define GPIO_P2                 2
  38      =1  #define GPIO_P3                 3
  39      =1  #define GPIO_P4                 4
  40      =1  #define GPIO_P5                 5
  41      =1  
  42      =1  
  43      =1  typedef struct
  44      =1  {
  45      =1          u8      Mode;           //IOÄ£Ê½,               GPIO_PullUp,GPIO_HighZ,GPIO_OUT_OD,GPIO_OUT_PP
  46      =1          u8      Pin;            //ÒªÉèÖÃµÄ¶Ë¿Ú  
  47      =1  } GPIO_InitTypeDef;
  48      =1  
  49      =1  u8      GPIO_Inilize(u8 GPIO, GPIO_InitTypeDef *GPIOx);
  50      =1  
  51      =1  #endif
   5          #include "eeprom.h"
   1      =1  
   2      =1  #ifndef __EEPROM_H
   3      =1  #define __EEPROM_H
   4      =1  
   5      =1  #include        "config.h"
   1      =2  
   2      =2  #ifndef         __CONFIG_H
           =2 #define         __CONFIG_H
           =2 
           =2 #include        "rtx51tny.h"
           =2 
           =2 /*********************************************************/
           =2 
           =2 //#define MAIN_Fosc             22118400L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 //#define MAIN_Fosc             12000000L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 #define MAIN_Fosc               11059200L       //¶¨ÒåÖ÷Ê±ÖÓ
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 23  

           =2 //#define MAIN_Fosc              5529600L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 //#define MAIN_Fosc             24000000L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 typedef  unsigned int uint;
           =2 typedef  unsigned char uchar;
           =2 
           =2 /*********************************************************/
           =2 #include        "STC15Fxxxx.H"
           =2 
           =2 
           =2 #include "stdlib.h"
           =2 #include <stdio.h>
           =2 #include <stdint.h>
           =2 
           =2 #endif
   6      =1  #include <stdint.h>
   1      =2  #ifndef __STDINT_H__
           =2 #define __STDINT_H__
           =2 
           =2 typedef unsigned char uint8_t;  //1Î»³¤¶È
           =2 typedef signed char int8_t;               //
           =2 typedef unsigned short uint16_t;  //2Î»³¤¶È
           =2 typedef signed short int16_t;
           =2 typedef unsigned long uint32_t;   //4Î»³¤¶È
           =2 typedef signed long int32_t;
           =2 
           =2 #endif
   7      =1  
   8      =1  //      Ñ¡ÔñMCUÐÍºÅ
   9      =1  #define MCU_Type        STC15F_L2K60S2  //STC15F_L2K08S2, STC15F_L2K16S2, STC15F_L2K24S2, STC15F_L2K32S2, STC15F_L
             -2K40S2, STC15F_L2K48S2, STC15F_L2K56S2, STC15F_L2K60S2, IAP15F_L2K61S2
  10      =1  
  11      =1  
  12      =1  /************************** ISP/IAP *****************************
  13      =1   IAPÏµÁÐ ¿ÉÒÔÔÚÓ¦ÓÃ³ÌÐòÐÞ¸ÄÓ¦ÓÃ³ÌÐò¡£
  14      =1  
  15      =1  STC15F/L2KxxS2  ÉÈÇø·ÖÅä£¬512×Ö½Ú/ÉÈÇø£¬´Ó0x0000¿ªÊ¼¡£
  16      =1  
  17      =1       ÐÍºÅ        ´óÐ¡   ÉÈÇøÊý  ¿ªÊ¼µØÖ·  ½áÊøµØÖ·   MOVC¶ÁÆ«ÒÆµØÖ·
  18      =1  STC15F/L2K08S2   53K   106ÉÈÇø  0x0000  ~  0xD3FF        0x2000
  19      =1  STC15F/L2K16S2   45K    90ÉÈÇø  0x0000  ~  0xB3FF        0x4000
  20      =1  STC15F/L2K24S2   37K    74ÉÈÇø  0x0000  ~  0x93FF        0x6000
  21      =1  STC15F/L2K32S2   29K    58ÉÈÇø  0x0000  ~  0x73FF        0x8000
  22      =1  STC15F/L2K40S2   21K    42ÉÈÇø  0x0000  ~  0x53FF        0xA000
  23      =1  STC15F/L2K48S2   13K    26ÉÈÇø  0x0000  ~  0x33FF        0xC000
  24      =1  STC15F/L2K56S2   5K     10ÉÈÇø  0x0000  ~  0x13FF        0xE000
  25      =1  STC15F/L2K60S2   1K      2ÉÈÇø  0x0000  ~  0x03FF        0xF000
  26      =1  
  27      =1  STC15F/L2K61S2   ÎÞEPROM, Õû¸ö122ÉÈÇøµÄFLASH¶¼¿ÉÒÔ²ÁÐ´ µØÖ· 0x0000~0xF3ff.
  28      =1  
  29      =1  */
  30      =1  
  31      =1  #if   (MCU_Type == STC15F_L2K08S2)
           =1       #define   MOVC_ShiftAddress    0x2000
           =1 #elif (MCU_Type == STC15F_L2K16S2)
           =1       #define   MOVC_ShiftAddress    0x4000
           =1 #elif (MCU_Type == STC15F_L2K24S2)
           =1       #define   MOVC_ShiftAddress    0x6000
           =1 #elif (MCU_Type == STC15F_L2K32S2)
           =1       #define   MOVC_ShiftAddress    0x8000
           =1 #elif (MCU_Type == STC15F_L2K40S2)
           =1       #define   MOVC_ShiftAddress    0xA000
           =1 #elif (MCU_Type == STC15F_L2K48S2)
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 24  

           =1       #define   MOVC_ShiftAddress    0xC000
           =1 #elif (MCU_Type == STC15F_L2K56S2)
           =1       #define   MOVC_ShiftAddress    0xE000
           =1 #elif (MCU_Type == STC15F_L2K60S2)
  46      =1        #define   MOVC_ShiftAddress    0xF000
  47      =1  #elif (MCU_Type == IAP15F_L2K61S2)
           =1       #define   MOVC_ShiftAddress    0x0000
           =1 #endif
  50      =1  
  51      =1  
  52      =1  
  53      =1  
  54      =1  void    DisableEEPROM(void);
  55      =1  void    EEPROM_read_n(uint16_t EE_address,uint8_t *DataAddress,uint16_t number);
  56      =1  void    EEPROM_write_n(uint16_t EE_address,uint8_t *DataAddress,uint16_t number);
  57      =1  void    EEPROM_SectorErase(uint16_t EE_address);
  58      =1  
  59      =1  
  60      =1  #endif
   6          
   7          #include <stdio.h>
   1      =1  /*--------------------------------------------------------------------------
   2      =1  STDIO.H
   3      =1  
   4      =1  Prototypes for standard I/O functions.
   5      =1  Copyright (c) 1988-2002 Keil Elektronik GmbH and Keil Software, Inc.
   6      =1  All rights reserved.
   7      =1  --------------------------------------------------------------------------*/
   8      =1  
   9      =1  #ifndef __STDIO_H__
           =1 #define __STDIO_H__
           =1 
           =1 #ifndef EOF
           =1  #define EOF -1
           =1 #endif
           =1 
           =1 #ifndef NULL
           =1  #define NULL ((void *) 0)
           =1 #endif
           =1 
           =1 #ifndef _SIZE_T
           =1  #define _SIZE_T
           =1  typedef unsigned int size_t;
           =1 #endif
           =1 
           =1 #pragma SAVE
           =1 #pragma REGPARMS
           =1 extern char _getkey (void);
           =1 extern char getchar (void);
           =1 extern char ungetchar (char);
           =1 extern char putchar (char);
           =1 extern int printf   (const char *, ...);
           =1 extern int sprintf  (char *, const char *, ...);
           =1 extern int vprintf  (const char *, char *);
           =1 extern int vsprintf (char *, const char *, char *);
           =1 extern char *gets (char *, int n);
           =1 extern int scanf (const char *, ...);
           =1 extern int sscanf (char *, const char *, ...);
           =1 extern int puts (const char *);
           =1 
           =1 #pragma RESTORE
           =1 
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 25  

           =1 #endif
  43      =1  
   8          #include <string.h>
   1      =1  /*--------------------------------------------------------------------------
   2      =1  STRING.H
   3      =1  
   4      =1  String functions.
   5      =1  Copyright (c) 1988-2002 Keil Elektronik GmbH and Keil Software, Inc.
   6      =1  All rights reserved.
   7      =1  --------------------------------------------------------------------------*/
   8      =1  
   9      =1  #ifndef __STRING_H__
  10      =1  #define __STRING_H__
  11      =1  
  12      =1  #ifndef _SIZE_T
           =1  #define _SIZE_T
           =1  typedef unsigned int size_t;
           =1 #endif
  16      =1  
  17      =1  #ifndef NULL
           =1  #define NULL ((void *) 0L)
           =1 #endif
  20      =1  
  21      =1  #pragma SAVE
  22      =1  #pragma REGPARMS
  23      =1  extern char *strcat (char *s1, char *s2);
  24      =1  extern char *strncat (char *s1, char *s2, int n);
  25      =1  
  26      =1  extern char strcmp (char *s1, char *s2);
  27      =1  extern char strncmp (char *s1, char *s2, int n);
  28      =1  
  29      =1  extern char *strcpy (char *s1, char *s2);
  30      =1  extern char *strncpy (char *s1, char *s2, int n);
  31      =1  
  32      =1  extern int strlen (char *);
  33      =1  
  34      =1  extern char *strchr (const char *s, char c);
  35      =1  extern int strpos (const char *s, char c);
  36      =1  extern char *strrchr (const char *s, char c);
  37      =1  extern int strrpos (const char *s, char c);
  38      =1  
  39      =1  extern int strspn (char *s, char *set);
  40      =1  extern int strcspn (char *s, char *set);
  41      =1  extern char *strpbrk (char *s, char *set);
  42      =1  extern char *strrpbrk (char *s, char *set);
  43      =1  extern char *strstr  (char *s, char *sub);
  44      =1  extern char *strtok  (char *str, const char *set);
  45      =1  
  46      =1  extern char memcmp (void *s1, void *s2, int n);
  47      =1  extern void *memcpy (void *s1, void *s2, int n);
  48      =1  extern void *memchr (void *s, char val, int n);
  49      =1  extern void *memccpy (void *s1, void *s2, char val, int n);
  50      =1  extern void *memmove (void *s1, void *s2, int n);
  51      =1  extern void *memset  (void *s, char val, int n);
  52      =1  #pragma RESTORE
  53      =1  
  54      =1  #endif
   9          #include "sys_clock.h"
   1      =1  
   2      =1  // Created by anche on 2018/8/14.
   3      =1  //
   4      =1  
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 26  

   5      =1  #ifndef _SYS_CLOCK__H
   6      =1  #define _SYS_CLOCK__H
   7      =1  
   8      =1  #include "config.h"
   1      =2  
   2      =2  #ifndef         __CONFIG_H
           =2 #define         __CONFIG_H
           =2 
           =2 #include        "rtx51tny.h"
           =2 
           =2 /*********************************************************/
           =2 
           =2 //#define MAIN_Fosc             22118400L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 //#define MAIN_Fosc             12000000L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 #define MAIN_Fosc               11059200L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 //#define MAIN_Fosc              5529600L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 //#define MAIN_Fosc             24000000L       //¶¨ÒåÖ÷Ê±ÖÓ
           =2 typedef  unsigned int uint;
           =2 typedef  unsigned char uchar;
           =2 
           =2 /*********************************************************/
           =2 #include        "STC15Fxxxx.H"
           =2 
           =2 
           =2 #include "stdlib.h"
           =2 #include <stdio.h>
           =2 #include <stdint.h>
           =2 
           =2 #endif
   9      =1  #include <stdint.h>
   1      =2  #ifndef __STDINT_H__
           =2 #define __STDINT_H__
           =2 
           =2 typedef unsigned char uint8_t;  //1Î»³¤¶È
           =2 typedef signed char int8_t;               //
           =2 typedef unsigned short uint16_t;  //2Î»³¤¶È
           =2 typedef signed short int16_t;
           =2 typedef unsigned long uint32_t;   //4Î»³¤¶È
           =2 typedef signed long int32_t;
           =2 
           =2 #endif
  10      =1  
  11      =1  typedef struct{
  12      =1      u16 ms;
  13      =1      u16 start;
  14      =1  //    u16 end;
  15      =1  }timer_out;
  16      =1  
  17      =1  extern timer_out timerout1, timerout2;
  18      =1  
  19      =1  extern data volatile uint16_t sys_ticks;
  20      =1  extern void sys_clock_init(void);
  21      =1  extern uint16_t get_sys_ticks(void);
  22      =1  
  23      =1  #endif //_SYS_CLOCK_H
  10          #include "function.h"
   1      =1  #ifndef __FUNCTION__H
   2      =1  #define __FUNCTION__H
   3      =1  
   4      =1  
   5      =1  void function(void);
   6      =1  
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 27  

   7      =1  void uart1_set_TimeOut(uint16_t ms);
   8      =1  void uart2_set_TimeOut(uint16_t ms);
   9      =1  void uart1_check_TimeOut(void);
  10      =1  void uart2_check_TimeOut(void);
  11      =1  
  12      =1  void usart1_and_usart2();
  13      =1  void usart1_cmd_write();
  14      =1  void gprs_conf();
  15      =1  #endif
  11          #include "aes.h"
   1      =1  #ifndef _AES_H_
   2      =1  #define _AES_H_
   3      =1  
   4      =1  #include <stdint.h>
   1      =2  #ifndef __STDINT_H__
           =2 #define __STDINT_H__
           =2 
           =2 typedef unsigned char uint8_t;  //1Î»³¤¶È
           =2 typedef signed char int8_t;               //
           =2 typedef unsigned short uint16_t;  //2Î»³¤¶È
           =2 typedef signed short int16_t;
           =2 typedef unsigned long uint32_t;   //4Î»³¤¶È
           =2 typedef signed long int32_t;
           =2 
           =2 #endif
   5      =1  
   6      =1  
   7      =1  // #define the macros below to 1/0 to enable/disable the mode of operation.
   8      =1  //
   9      =1  // CBC enables AES128 encryption in CBC-mode of operation and handles 0-padding.
  10      =1  // ECB enables the basic ECB 16-byte block algorithm. Both can be enabled simultaneously.
  11      =1  
  12      =1  // The #ifndef-guard allows it to be configured before #include'ing or at compile time.
  13      =1  #ifndef CBC
  14      =1    #define CBC 1
  15      =1  #endif
  16      =1  
  17      =1  #ifndef ECB
  18      =1    #define ECB 1
  19      =1  #endif
  20      =1  
  21      =1  
  22      =1  
  23      =1  #if defined(ECB) && ECB
  24      =1  
  25      =1  void AES128_ECB_encrypt(const uint8_t* input, const uint8_t* key, uint8_t *output);
  26      =1  void AES128_ECB_decrypt(const uint8_t* input, const uint8_t* key, uint8_t *output);
  27      =1  
  28      =1  #endif // #if defined(ECB) && ECB
  29      =1  
  30      =1  
  31      =1  #if defined(CBC) && CBC
  32      =1  
  33      =1  void AES128_CBC_encrypt_buffer(uint8_t* output, uint8_t* input, uint32_t length, const uint8_t* key, const
             - uint8_t* iv);
  34      =1  void AES128_CBC_decrypt_buffer(uint8_t* output, uint8_t* input, uint32_t length, const uint8_t* key, const
             - uint8_t* iv);
  35      =1  
  36      =1  #endif // #if defined(CBC) && CBC
  37      =1  
  38      =1  
  39      =1  
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 28  

  40      =1  #endif //_AES_H_
  12          #include "aes128app.h"
   1      =1  #ifndef __AES128APP_H
   2      =1  #define __AES128APP_H
   3      =1  
   4      =1  typedef struct{
   5      =1          uint8_t id[8];
   6      =1          uint8_t key[16];
   7      =1          uint8_t iv[16];
   8      =1          uint8_t state;
   9      =1  }AES128;
  10      =1  
  11      =1  extern AES128 aes128;
  12      =1  
  13      =1  typedef struct{
  14      =1          uint8_t *baud;
  15      =1          uint8_t *server;
  16      =1  }S_config;
  17      =1  
  18      =1  extern S_config s_config;
  19      =1  
  20      =1  
  21      =1  int app_encrypt_cbc(uint8_t *key, uint8_t *iv, uint8_t *in, uint8_t len, uint8_t *out); //EBC¼ÓÃÜ
  22      =1  int app_decrypt_cbc(uint8_t *key, uint8_t *iv, uint8_t *in, uint8_t *out); //EBC½âÃÜ
  23      =1  
  24      =1  
  25      =1  #endif
  13          #include "crc16.h"
   1      =1  #ifndef __CRC16_h
   2      =1  #define __CRC16_h
   3      =1  
   4      =1  /********************************************************
   5      =1  *Ãû³Æ£º                 crc16
   6      =1  *¹¦ÄÜ£º                 16Î»CRCÐ£Ñé
   7      =1  *ÊäÈë£º                 *puchMsg                £º´ýÐ£ÑéÊý×é
   8      =1                  usDataLen               : ´ýÐ£ÑéÊý×é³¤¶È
   9      =1  *·µ»Ø£º                 16Î»Ð£ÑéÂë
  10      =1  ********************************************************/
  11      =1  uint16_t crc16(uint8_t *puchMsg, uint16_t usDataLen);
  12      =1  uint16_t crc16_2(uint8_t *puchMsg1, uint16_t usDataLen1,  uint8_t *puchMsg2,  uint16_t usDataLen2);
  13      =1  
  14      =1  #endif
  14          
  15          timer_out timerout1, timerout2;          //¶¨Òå³¬Ê±½á¹¹Ìå
  16          S_config s_config;
  17          AES128 aes128={ 
  18                                          {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07},
  19                                          {0x2b, 0x7e, 0x15, 0x16, 0x28, 0xae, 0xd2, 0xa6, 0xab, 0xf7, 0x15, 0x88, 0x09, 0xcf, 0x4f, 0x3c },
  20                                      {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f 
             -}                                
  21                                          };
  22          
  23          
  24          //void uart_check_TimeOut(void);
  25          void usart1_cmd_write(void);
  26          void usart1_and_usart2(void);
  27          extern void USRT2_config(u32 buad);
  28          void function(void)
  29          {
  30   1              u32 baud;
  31   1              char *ptr,sta=0;
  32   1              uart1_cmd = 0; //ÃüÁî½ÓÊÕ
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 29  

  33   1      
  34   1              //id 
  35   1              EEPROM_read_n(0x00,RX2_Buffer,41);
  36   1          delay_ms(6);
  37   1              memcpy(aes128.key, &RX2_Buffer[0],16);
  38   1              memcpy(aes128.iv, &RX2_Buffer[16],16);
  39   1              memcpy(aes128.id, &RX2_Buffer[32],8);
  40   1          aes128.state = RX2_Buffer[40];
  41   1      
  42   1              //serial
  43   1              EEPROM_read_n(513,RX2_Buffer,32);
  44   1          delay_ms(6);
  45   1              memset(s_config.baud,0,4);
  46   1              ptr = strtok(RX2_Buffer,";");
  47   1              while(ptr!=0){
  48   2                 if(sta==0)
  49   2                 s_config.baud = ptr;
  50   2                 if(sta==1)
  51   2                 s_config.server = ptr;
  52   2              }
  53   1              baud = ((s_config.baud[3]<<32)&0xff)|((s_config.baud[2]<<16)&0xff)|((s_config.baud[1]<<8)&0xff)|(s_config
             -.baud[0]&0xff);
  54   1              USRT2_config(baud);
  55   1      
  56   1              printf("key=%0.2x\n",aes128.key);
  57   1              printf("iv=%0.2x\n",aes128.iv);
  58   1              printf("id=%0.2x\n",aes128.id);
  59   1              printf("baud=%d\n",baud);
  60   1              printf("server=%0.2x\n",s_config.server);
  61   1              while(1)
  62   1              {
  63   2               /*      uart1_cmd = 0 ½øÈëÕý³£·¢Êý¾Ý
  64   2                *      uart1_cmd = 1 ½øÈë½øÈëÅäÖÃÄ£Ê½
  65   2                *  uart1_cmd = 2 ½øÈë²éÑ¯Ä£Ê½ 
  66   2                *  uart1_cmd = 3 ½øÈëµ¥Æ¬»ú±£´æÊý¾Ý£»
  67   2                *  uart1_cmd = 4 ½øÈëGPRSÅäÖÃÊý¾Ý
  68   2                *  uart1_cmd = 5 ÍË³öÅäÖÃÄ£Ê½  
  69   2                */
  70   2                if(aes128.state==2)   //¼ÓÃÜÄ£Ê½
  71   2                {
  72   3                      uart1_check_TimeOut();  //´®¿Ú³¬Ê±¼ì²â
  73   3                      uart2_check_TimeOut(); 
  74   3                      }
  75   2                if(aes128.state==1)    //Í¸´«Ä£Ê½
  76   2                {
  77   3                       usart1_and_usart2();
  78   3                }             
  79   2                      os_wait2(K_SIG|K_TMO,1);                                
  80   2              }
  81   1      }
  82          
  83          #if 1
  84          /*
  85          *´®¿Ú½ÓÊÕ³¬Ê±ÉèÖÃ
  86          * ¹¦ÄÜ£ºÉèÖÃ»òË¢ÐÂ³¬Ê±Ê±¼ä
  87          */
  88          void uart1_set_TimeOut(uint16_t ms)
  89          {
  90   1      
  91   1          timerout1.start = get_sys_ticks();
  92   1          timerout1.ms = ms;
  93   1      }
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 30  

  94          
  95          void uart2_set_TimeOut(uint16_t ms)
  96          {
  97   1      
  98   1          timerout2.start = get_sys_ticks();
  99   1          timerout2.ms = ms;
 100   1      }
 101          
 102          /*
 103          *´®¿Ú½ÓÊÕ³¬Ê±¼ì²â
 104          */
 105          //u8 code sbuf1[]={0xc3,0x01};
 106          //u8 code cc[]={0xC3, 0x01, 
 107          //                        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 
 108          //                        0x00, 0x10, 
 109          //                        0x86, 0xE2, 0x93, 0x97, 0x4B, 0x38, 0x3F, 0xA5, 0x10, 0xF0, 0x76, 0xBF, 0xD8, 0x6E, 0x68, 0x72
 110          //                        };
 111          void uart1_check_TimeOut(void)
 112          {
 113   1          uint16_t count1;
 114   1              uint8_t  tmp[20];
 115   1              uint16_t crc;
 116   1              uint16_t data_len;
 117   1          if(COM1.RX_TimeOut > 0)             //³¬Ê±¼ÆÊý
 118   1          {
 119   2              count1 = get_sys_ticks();
 120   2              if((count1 - timerout1.start)>timerout1.ms)
 121   2              {
 122   3      //            COM1.RX_TimeOut = 0;  //½ÓÊÕ³¬Ê±ÇåÁã
 123   3      //            COM1.RX_Cnt = 0;            //½ÓÊÕ¼ÆÊýÇåÁã
 124   3                  /*
 125   3                   *´®¿Ú1¼ì²â³¬Ê±¶¯×÷
 126   3                   *¼ÓÃÜ¡¢·â°ü´®¿Ú2·¢ËÍ
 127   3                  */
 128   3                              //app_encrypt_cbc(uint8_t *key, uint8_t *iv, uint8_t *in, uint8_t len, uint8_t *out);; //EBC¼ÓÃÜ
 129   3                  data_len = app_encrypt_cbc(aes128.key, aes128.iv, RX1_Buffer, COM1.RX_TimeOut-1, TX2_Buffer);       
             -  //¼ÓÃÜ·µ»ØÊý¾Ý³¤¶ÈRX2_Buffer        
 130   3      //                      Printf1(RX2_Buffer,COM1.RX_TimeOut);  //data    
 131   3      
 132   3      //                  tmp[0] = sbuf1[0];
 133   3      //                      tmp[1] = sbuf1[1];
 134   3                              memcpy(&tmp[2], aes128.id, 8);
 135   3                              tmp[10] = (data_len>>8)&0xff;
 136   3                              tmp[11] = data_len&0xff;
 137   3      
 138   3                              crc = crc16_2(tmp, 12, TX2_Buffer, data_len);  
 139   3      
 140   3                              Printf2(tmp,12);                        //head cmd id(8B) len(2B)
 141   3                              Printf2(TX2_Buffer,data_len);  //data
 142   3                              TX2_write2buff((crc>>8)&0xff);    //crc
 143   3                              TX2_write2buff(crc&0xff);                 //crc
 144   3                              TX2_write2buff(0xe7);                     //end
 145   3      
 146   3                              COM1.RX_TimeOut = 0;  //½ÓÊÕ³¬Ê±ÇåÁã
 147   3                  COM1.RX_Cnt = 0;      //½ÓÊÕ¼ÆÊýÇåÁã
 148   3              }
 149   2          }
 150   1      }
 151          
 152          void uart2_check_TimeOut(void)
 153          {
 154   1               uint16_t count2;
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 31  

 155   1              
 156   1          if(COM2.RX_TimeOut > 0)             //³¬Ê±¼ÆÊý
 157   1          {
 158   2              count2 = get_sys_ticks();
 159   2              if((count2 - timerout2.start)>timerout2.ms)
 160   2              {            
 161   3                  /*
 162   3                   *´®¿Ú2¼ì²â³¬Ê±¶¯×÷
 163   3                   * ¼ÓÃÜ¡¢·â°ü´®¿Ú2·¢ËÍ
 164   3                  */ 
 165   3      //                      PrintString1(RX2_Buffer);
 166   3      //                      printf("123");
 167   3                              COM2.RX_TimeOut = 0;  //½ÓÊÕ³¬Ê±ÇåÁã
 168   3                  COM2.RX_Cnt = 0;      //½ÓÊÕ¼ÆÊýÇåÁã
 169   3              }
 170   2          }
 171   1      }
 172          #endif
 173          
 174          
 175          
 176          void usart1_cmd_write()
 177          {
 178   1      
 179   1      //void  EEPROM_write_n(uint16_t EE_address,uint8_t *DataAddress,uint16_t number);
 180   1      //void  EEPROM_SectorErase(uint16_t EE_address);
 181   1              printf(RX1_Buffer);
 182   1              memcpy(aes128.id, &RX1_Buffer[1], 8);
 183   1              memcpy(aes128.key, &RX1_Buffer[9], 16);
 184   1              memcpy(aes128.iv, &RX1_Buffer[25], 16);
 185   1      //      
 186   1      //      EEPROM_SectorErase(0x00);
 187   1      //      delay_ms(6);            //²Á³ýÊ±¼ä4ms~6ms  
 188   1      //      EEPROM_write_n(0x00,&RX1_Buffer[0],COM1.RX_Cnt);          //uart1_cnt = 48Byte
 189   1              delay_ms(6);
 190   1              Printf1("ok",2);
 191   1              memset(RX1_Buffer,0,128);
 192   1              COM1.RX_Cnt = 0;
 193   1      //      ISP_CONTR = 0x60; //ÅäÖÃ³É¹¦ÖØÆô
 194   1      }
 195          void gprs_conf()
 196          {
 197   1              EEPROM_SectorErase(513);
 198   1              delay_ms(6);            //²Á³ýÊ±¼ä4ms~6ms  
 199   1              EEPROM_write_n(513,&RX1_Buffer[0],COM1.RX_Cnt);   //uart1_cnt = 48Byte
 200   1              delay_ms(6);
 201   1              Printf1("ok",2);
 202   1      }
 203          sbit LED1 = P1^1;
 204          sbit LED2 = P1^2;
 205          sbit LED_state1 = P1^3;
 206          sbit GPIO_power = P1^4;
 207          
 208          void MCU_check(uint16_t check_time)
 209          {
 210   1              static uint16_t start_T;
 211   1              static uint8_t CT;
 212   1              if(CT == 0)
 213   1              {
 214   2                      start_T = get_sys_ticks();
 215   2                      CT = 1;
 216   2              }
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 32  

 217   1      
 218   1              if((get_sys_ticks() - start_T)>check_time)
 219   1              {
 220   2                      CT = 0;
 221   2                      if((LED1 || LED2) == 1)
 222   2                      {
 223   3                              LED_state1 = 1;
 224   3                              delay_ms(10000);
 225   3                              LED_state1 = 0; 
 226   3                      }
 227   2                      else
 228   2                      {
 229   3                         GPIO_power = 1;
 230   3                         delay_ms(2000);
 231   3                         GPIO_power = 0;
 232   3                      }
 233   2              }       
 234   1      }
 235          
 236          void usart1_and_usart2()
 237          {
 238   1              uint16_t i;
 239   1              if((COM1.RX_TimeOut > 0)&&(COM2.RX_TimeOut == 0))               //³¬Ê±¼ÆÊý
 240   1              {
 241   2                      if(--COM1.RX_TimeOut == 0)
 242   2                      {
 243   3                              if(COM1.RX_Cnt > 0)
 244   3                              {
 245   4                                      for(i=0; i<COM1.RX_Cnt; i++)    TX2_write2buff(RX1_Buffer[i]);  //ÊÕµ½µÄÊý¾ÝÔ­Ñù·µ»Ø
 246   4                              }
 247   3                              COM1.RX_Cnt = 0;
 248   3                      }
 249   2              }
 250   1              if((COM2.RX_TimeOut > 0) && (COM1.RX_TimeOut == 0))             //³¬Ê±¼ÆÊý
 251   1              {
 252   2                      if(--COM2.RX_TimeOut == 0)
 253   2                      {
 254   3                              if(COM2.RX_Cnt > 0)
 255   3                              {
 256   4                                      for(i=0; i<COM2.RX_Cnt; i++)    TX1_write2buff(RX2_Buffer[i]);  //ÊÕµ½µÄÊý¾ÝÔ­Ñù·µ»Ø
 257   4                              }
 258   3                              COM2.RX_Cnt = 0;
 259   3                      }
 260   2              }
 261   1      }
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 33  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION function (BEGIN)
                                           ; SOURCE LINE # 28
                                           ; SOURCE LINE # 29
                                           ; SOURCE LINE # 31
0000 E4                CLR     A
0001 900000      R     MOV     DPTR,#sta
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 32
0005 900000      E     MOV     DPTR,#uart1_cmd
0008 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 35
0009 7B01              MOV     R3,#01H
000B 7A00        E     MOV     R2,#HIGH RX2_Buffer
000D 7900        E     MOV     R1,#LOW RX2_Buffer
000F 900000      E     MOV     DPTR,#?_EEPROM_read_n?BYTE+05H
0012 F0                MOVX    @DPTR,A
0013 A3                INC     DPTR
0014 7429              MOV     A,#029H
0016 F0                MOVX    @DPTR,A
0017 E4                CLR     A
0018 FF                MOV     R7,A
0019 FE                MOV     R6,A
001A 120000      E     LCALL   _EEPROM_read_n
                                           ; SOURCE LINE # 36
001D 7F06              MOV     R7,#06H
001F 7E00              MOV     R6,#00H
0021 120000      E     LCALL   _delay_ms
                                           ; SOURCE LINE # 37
0024 7800        R     MOV     R0,#LOW aes128+08H
0026 7C00        R     MOV     R4,#HIGH aes128+08H
0028 7D01              MOV     R5,#01H
002A 7B01              MOV     R3,#01H
002C 7A00        E     MOV     R2,#HIGH RX2_Buffer
002E 7900        E     MOV     R1,#LOW RX2_Buffer
0030 7E00              MOV     R6,#00H
0032 7F10              MOV     R7,#010H
0034 120000      E     LCALL   ?C?COPY
                                           ; SOURCE LINE # 38
0037 7800        R     MOV     R0,#LOW aes128+018H
0039 7C00        R     MOV     R4,#HIGH aes128+018H
003B 7D01              MOV     R5,#01H
003D 7B01              MOV     R3,#01H
003F 7A00        E     MOV     R2,#HIGH RX2_Buffer+010H
0041 7900        E     MOV     R1,#LOW RX2_Buffer+010H
0043 7E00              MOV     R6,#00H
0045 7F10              MOV     R7,#010H
0047 120000      E     LCALL   ?C?COPY
                                           ; SOURCE LINE # 39
004A 7800        R     MOV     R0,#LOW aes128
004C 7C00        R     MOV     R4,#HIGH aes128
004E 7D01              MOV     R5,#01H
0050 7B01              MOV     R3,#01H
0052 7A00        E     MOV     R2,#HIGH RX2_Buffer+020H
0054 7900        E     MOV     R1,#LOW RX2_Buffer+020H
0056 7E00              MOV     R6,#00H
0058 7F08              MOV     R7,#08H
005A 120000      E     LCALL   ?C?COPY
                                           ; SOURCE LINE # 40
005D 900000      E     MOV     DPTR,#RX2_Buffer+028H
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 34  

0060 E0                MOVX    A,@DPTR
0061 900000      R     MOV     DPTR,#aes128+028H
0064 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 43
0065 7B01              MOV     R3,#01H
0067 7A00        E     MOV     R2,#HIGH RX2_Buffer
0069 7900        E     MOV     R1,#LOW RX2_Buffer
006B 900000      E     MOV     DPTR,#?_EEPROM_read_n?BYTE+05H
006E E4                CLR     A
006F F0                MOVX    @DPTR,A
0070 A3                INC     DPTR
0071 7420              MOV     A,#020H
0073 F0                MOVX    @DPTR,A
0074 7F01              MOV     R7,#01H
0076 7E02              MOV     R6,#02H
0078 120000      E     LCALL   _EEPROM_read_n
                                           ; SOURCE LINE # 44
007B 7F06              MOV     R7,#06H
007D 7E00              MOV     R6,#00H
007F 120000      E     LCALL   _delay_ms
                                           ; SOURCE LINE # 45
0082 7E00              MOV     R6,#00H
0084 7F04              MOV     R7,#04H
0086 7D00              MOV     R5,#00H
0088 900000      R     MOV     DPTR,#s_config
008B E0                MOVX    A,@DPTR
008C FB                MOV     R3,A
008D A3                INC     DPTR
008E E0                MOVX    A,@DPTR
008F FA                MOV     R2,A
0090 A3                INC     DPTR
0091 E0                MOVX    A,@DPTR
0092 F9                MOV     R1,A
0093 120000      E     LCALL   ?C?MEMSET
                                           ; SOURCE LINE # 46
0096 900000      E     MOV     DPTR,#?_strtok?BYTE+03H
0099 74FF              MOV     A,#0FFH
009B F0                MOVX    @DPTR,A
009C A3                INC     DPTR
009D 7400        R     MOV     A,#HIGH ?SC_0
009F F0                MOVX    @DPTR,A
00A0 A3                INC     DPTR
00A1 7400        R     MOV     A,#LOW ?SC_0
00A3 F0                MOVX    @DPTR,A
00A4 7B01              MOV     R3,#01H
00A6 7A00        E     MOV     R2,#HIGH RX2_Buffer
00A8 7900        E     MOV     R1,#LOW RX2_Buffer
00AA 120000      E     LCALL   _strtok
00AD 900000      R     MOV     DPTR,#ptr
00B0 EB                MOV     A,R3
00B1 8030              SJMP    ?C0045
00B3         ?C0001:
                                           ; SOURCE LINE # 47
00B3 900000      R     MOV     DPTR,#ptr
00B6 E0                MOVX    A,@DPTR
00B7 FB                MOV     R3,A
00B8 A3                INC     DPTR
00B9 E0                MOVX    A,@DPTR
00BA FA                MOV     R2,A
00BB A3                INC     DPTR
00BC E0                MOVX    A,@DPTR
00BD F9                MOV     R1,A
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 35  

00BE 4A                ORL     A,R2
00BF 602B              JZ      ?C0002
                                           ; SOURCE LINE # 48
00C1 A3                INC     DPTR
00C2 E0                MOVX    A,@DPTR
00C3 FF                MOV     R7,A
00C4 700B              JNZ     ?C0003
                                           ; SOURCE LINE # 49
00C6 900000      R     MOV     DPTR,#s_config
00C9 EB                MOV     A,R3
00CA F0                MOVX    @DPTR,A
00CB A3                INC     DPTR
00CC EA                MOV     A,R2
00CD F0                MOVX    @DPTR,A
00CE A3                INC     DPTR
00CF E9                MOV     A,R1
00D0 F0                MOVX    @DPTR,A
00D1         ?C0003:
                                           ; SOURCE LINE # 50
00D1 EF                MOV     A,R7
00D2 B401DE            CJNE    A,#01H,?C0001
                                           ; SOURCE LINE # 51
00D5 900000      R     MOV     DPTR,#ptr
00D8 E0                MOVX    A,@DPTR
00D9 F9                MOV     R1,A
00DA A3                INC     DPTR
00DB E0                MOVX    A,@DPTR
00DC FA                MOV     R2,A
00DD A3                INC     DPTR
00DE E0                MOVX    A,@DPTR
00DF 900000      R     MOV     DPTR,#s_config+03H
00E2 C9                XCH     A,R1
00E3         ?C0045:
00E3 F0                MOVX    @DPTR,A
00E4 A3                INC     DPTR
00E5 EA                MOV     A,R2
00E6 F0                MOVX    @DPTR,A
00E7 A3                INC     DPTR
00E8 E9                MOV     A,R1
00E9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 52
00EA 80C7              SJMP    ?C0001
00EC         ?C0002:
                                           ; SOURCE LINE # 53
00EC 900000      R     MOV     DPTR,#s_config
00EF E0                MOVX    A,@DPTR
00F0 FB                MOV     R3,A
00F1 A3                INC     DPTR
00F2 E0                MOVX    A,@DPTR
00F3 FA                MOV     R2,A
00F4 A3                INC     DPTR
00F5 E0                MOVX    A,@DPTR
00F6 F9                MOV     R1,A
00F7 900002            MOV     DPTR,#02H
00FA 120000      E     LCALL   ?C?CLDOPTR
00FD 7E00              MOV     R6,#00H
00FF 7810              MOV     R0,#010H
0101         ?C0041:
0101 C3                CLR     C
0102 33                RLC     A
0103 CE                XCH     A,R6
0104 33                RLC     A
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 36  

0105 CE                XCH     A,R6
0106 D8F9              DJNZ    R0,?C0041
0108 7C00              MOV     R4,#00H
010A FD                MOV     R5,A
010B 900003            MOV     DPTR,#03H
010E 120000      E     LCALL   ?C?CLDOPTR
0111 7E00              MOV     R6,#00H
0113 7820              MOV     R0,#020H
0115         ?C0042:
0115 C3                CLR     C
0116 33                RLC     A
0117 CE                XCH     A,R6
0118 33                RLC     A
0119 CE                XCH     A,R6
011A D8F9              DJNZ    R0,?C0042
011C FF                MOV     R7,A
011D EF                MOV     A,R7
011E 4D                ORL     A,R5
011F FD                MOV     R5,A
0120 900001            MOV     DPTR,#01H
0123 120000      E     LCALL   ?C?CLDOPTR
0126 EC                MOV     A,R4
0127 FE                MOV     R6,A
0128 ED                MOV     A,R5
0129 FF                MOV     R7,A
012A 120000      E     LCALL   ?C?CLDPTR
012D FD                MOV     R5,A
012E EF                MOV     A,R7
012F 4D                ORL     A,R5
0130 FF                MOV     R7,A
0131 E4                CLR     A
0132 FC                MOV     R4,A
0133 FD                MOV     R5,A
0134 900000      R     MOV     DPTR,#baud
0137 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 54
013A 900000      R     MOV     DPTR,#baud
013D E0                MOVX    A,@DPTR
013E FC                MOV     R4,A
013F A3                INC     DPTR
0140 E0                MOVX    A,@DPTR
0141 FD                MOV     R5,A
0142 A3                INC     DPTR
0143 E0                MOVX    A,@DPTR
0144 FE                MOV     R6,A
0145 A3                INC     DPTR
0146 E0                MOVX    A,@DPTR
0147 FF                MOV     R7,A
0148 120000      E     LCALL   _USRT2_config
                                           ; SOURCE LINE # 56
014B 900000      E     MOV     DPTR,#?_printf?BYTE+03H
014E 7401              MOV     A,#01H
0150 F0                MOVX    @DPTR,A
0151 A3                INC     DPTR
0152 7400        R     MOV     A,#HIGH aes128+08H
0154 F0                MOVX    @DPTR,A
0155 A3                INC     DPTR
0156 7400        R     MOV     A,#LOW aes128+08H
0158 F0                MOVX    @DPTR,A
0159 7BFF              MOV     R3,#0FFH
015B 7A00        R     MOV     R2,#HIGH ?SC_2
015D 7900        R     MOV     R1,#LOW ?SC_2
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 37  

015F 120000      E     LCALL   _printf
                                           ; SOURCE LINE # 57
0162 900000      E     MOV     DPTR,#?_printf?BYTE+03H
0165 7401              MOV     A,#01H
0167 F0                MOVX    @DPTR,A
0168 A3                INC     DPTR
0169 7400        R     MOV     A,#HIGH aes128+018H
016B F0                MOVX    @DPTR,A
016C A3                INC     DPTR
016D 7400        R     MOV     A,#LOW aes128+018H
016F F0                MOVX    @DPTR,A
0170 7BFF              MOV     R3,#0FFH
0172 7A00        R     MOV     R2,#HIGH ?SC_13
0174 7900        R     MOV     R1,#LOW ?SC_13
0176 120000      E     LCALL   _printf
                                           ; SOURCE LINE # 58
0179 900000      E     MOV     DPTR,#?_printf?BYTE+03H
017C 7401              MOV     A,#01H
017E F0                MOVX    @DPTR,A
017F A3                INC     DPTR
0180 7400        R     MOV     A,#HIGH aes128
0182 F0                MOVX    @DPTR,A
0183 A3                INC     DPTR
0184 7400        R     MOV     A,#LOW aes128
0186 F0                MOVX    @DPTR,A
0187 7BFF              MOV     R3,#0FFH
0189 7A00        R     MOV     R2,#HIGH ?SC_23
018B 7900        R     MOV     R1,#LOW ?SC_23
018D 120000      E     LCALL   _printf
                                           ; SOURCE LINE # 59
0190 7BFF              MOV     R3,#0FFH
0192 7A00        R     MOV     R2,#HIGH ?SC_33
0194 7900        R     MOV     R1,#LOW ?SC_33
0196 900000      R     MOV     DPTR,#baud
0199 E0                MOVX    A,@DPTR
019A FC                MOV     R4,A
019B A3                INC     DPTR
019C E0                MOVX    A,@DPTR
019D FD                MOV     R5,A
019E A3                INC     DPTR
019F E0                MOVX    A,@DPTR
01A0 FE                MOV     R6,A
01A1 A3                INC     DPTR
01A2 E0                MOVX    A,@DPTR
01A3 FF                MOV     R7,A
01A4 900000      E     MOV     DPTR,#?_printf?BYTE+03H
01A7 120000      E     LCALL   ?C?LSTXDATA
01AA 120000      E     LCALL   _printf
                                           ; SOURCE LINE # 60
01AD 900000      R     MOV     DPTR,#s_config+03H
01B0 E0                MOVX    A,@DPTR
01B1 F9                MOV     R1,A
01B2 A3                INC     DPTR
01B3 E0                MOVX    A,@DPTR
01B4 FA                MOV     R2,A
01B5 A3                INC     DPTR
01B6 E0                MOVX    A,@DPTR
01B7 900000      E     MOV     DPTR,#?_printf?BYTE+03H
01BA C9                XCH     A,R1
01BB F0                MOVX    @DPTR,A
01BC A3                INC     DPTR
01BD EA                MOV     A,R2
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 38  

01BE F0                MOVX    @DPTR,A
01BF A3                INC     DPTR
01C0 E9                MOV     A,R1
01C1 F0                MOVX    @DPTR,A
01C2 7BFF              MOV     R3,#0FFH
01C4 7A00        R     MOV     R2,#HIGH ?SC_42
01C6 7900        R     MOV     R1,#LOW ?SC_42
01C8 120000      E     LCALL   _printf
01CB         ?C0005:
                                           ; SOURCE LINE # 61
                                           ; SOURCE LINE # 62
                                           ; SOURCE LINE # 70
01CB 900000      R     MOV     DPTR,#aes128+028H
01CE E0                MOVX    A,@DPTR
01CF B40206            CJNE    A,#02H,?C0007
                                           ; SOURCE LINE # 71
                                           ; SOURCE LINE # 72
01D2 120000      R     LCALL   uart1_check_TimeOut
                                           ; SOURCE LINE # 73
01D5 120000      R     LCALL   uart2_check_TimeOut
                                           ; SOURCE LINE # 74
01D8         ?C0007:
                                           ; SOURCE LINE # 75
01D8 900000      R     MOV     DPTR,#aes128+028H
01DB E0                MOVX    A,@DPTR
01DC B40103            CJNE    A,#01H,?C0008
                                           ; SOURCE LINE # 76
                                           ; SOURCE LINE # 77
01DF 120000      R     LCALL   usart1_and_usart2
                                           ; SOURCE LINE # 78
01E2         ?C0008:
                                           ; SOURCE LINE # 79
01E2 7D01              MOV     R5,#01H
01E4 7F03              MOV     R7,#03H
01E6 120000      E     LCALL   _os_wait2
                                           ; SOURCE LINE # 80
01E9 80E0              SJMP    ?C0005
             ; FUNCTION function (END)

             ; FUNCTION _uart1_set_TimeOut (BEGIN)
                                           ; SOURCE LINE # 88
0000 900000      R     MOV     DPTR,#ms
0003 EE                MOV     A,R6
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 89
                                           ; SOURCE LINE # 91
0008 120000      E     LCALL   get_sys_ticks
000B 900000      R     MOV     DPTR,#timerout1+02H
000E EE                MOV     A,R6
000F F0                MOVX    @DPTR,A
0010 A3                INC     DPTR
0011 EF                MOV     A,R7
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 92
0013 900000      R     MOV     DPTR,#ms
0016 E0                MOVX    A,@DPTR
0017 FF                MOV     R7,A
0018 A3                INC     DPTR
0019 E0                MOVX    A,@DPTR
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 39  

001A 900000      R     MOV     DPTR,#timerout1
001D CF                XCH     A,R7
001E F0                MOVX    @DPTR,A
001F A3                INC     DPTR
0020 EF                MOV     A,R7
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 93
0022 22                RET     
             ; FUNCTION _uart1_set_TimeOut (END)

             ; FUNCTION _uart2_set_TimeOut (BEGIN)
                                           ; SOURCE LINE # 95
0000 900000      R     MOV     DPTR,#ms
0003 EE                MOV     A,R6
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 96
                                           ; SOURCE LINE # 98
0008 120000      E     LCALL   get_sys_ticks
000B 900000      R     MOV     DPTR,#timerout2+02H
000E EE                MOV     A,R6
000F F0                MOVX    @DPTR,A
0010 A3                INC     DPTR
0011 EF                MOV     A,R7
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 99
0013 900000      R     MOV     DPTR,#ms
0016 E0                MOVX    A,@DPTR
0017 FF                MOV     R7,A
0018 A3                INC     DPTR
0019 E0                MOVX    A,@DPTR
001A 900000      R     MOV     DPTR,#timerout2
001D CF                XCH     A,R7
001E F0                MOVX    @DPTR,A
001F A3                INC     DPTR
0020 EF                MOV     A,R7
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 100
0022 22                RET     
             ; FUNCTION _uart2_set_TimeOut (END)

             ; FUNCTION uart1_check_TimeOut (BEGIN)
                                           ; SOURCE LINE # 111
                                           ; SOURCE LINE # 112
                                           ; SOURCE LINE # 117
0000 900000      E     MOV     DPTR,#COM1+05H
0003 E0                MOVX    A,@DPTR
0004 D3                SETB    C
0005 9400              SUBB    A,#00H
0007 5003              JNC     $ + 5H
0009 020000      R     LJMP    ?C0014
                                           ; SOURCE LINE # 118
                                           ; SOURCE LINE # 119
000C 120000      E     LCALL   get_sys_ticks
;---- Variable 'count1' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 120
000F 900000      R     MOV     DPTR,#timerout1+02H
0012 E0                MOVX    A,@DPTR
0013 FC                MOV     R4,A
0014 A3                INC     DPTR
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 40  

0015 E0                MOVX    A,@DPTR
0016 FD                MOV     R5,A
0017 C3                CLR     C
0018 EF                MOV     A,R7
0019 9D                SUBB    A,R5
001A FF                MOV     R7,A
001B EE                MOV     A,R6
001C 9C                SUBB    A,R4
001D FE                MOV     R6,A
001E C3                CLR     C
001F 900000      R     MOV     DPTR,#timerout1+01H
0022 E0                MOVX    A,@DPTR
0023 9F                SUBB    A,R7
0024 900000      R     MOV     DPTR,#timerout1
0027 E0                MOVX    A,@DPTR
0028 9E                SUBB    A,R6
0029 4003              JC      $ + 5H
002B 020000      R     LJMP    ?C0014
                                           ; SOURCE LINE # 121
                                           ; SOURCE LINE # 129
002E 900000      E     MOV     DPTR,#?_app_encrypt_cbc?BYTE+03H
0031 7401              MOV     A,#01H
0033 F0                MOVX    @DPTR,A
0034 A3                INC     DPTR
0035 7400        R     MOV     A,#HIGH aes128+018H
0037 F0                MOVX    @DPTR,A
0038 A3                INC     DPTR
0039 7400        R     MOV     A,#LOW aes128+018H
003B F0                MOVX    @DPTR,A
003C A3                INC     DPTR
003D 7401              MOV     A,#01H
003F F0                MOVX    @DPTR,A
0040 A3                INC     DPTR
0041 7400        E     MOV     A,#HIGH RX1_Buffer
0043 F0                MOVX    @DPTR,A
0044 A3                INC     DPTR
0045 7400        E     MOV     A,#LOW RX1_Buffer
0047 F0                MOVX    @DPTR,A
0048 900000      E     MOV     DPTR,#COM1+05H
004B E0                MOVX    A,@DPTR
004C 14                DEC     A
004D 900000      E     MOV     DPTR,#?_app_encrypt_cbc?BYTE+09H
0050 F0                MOVX    @DPTR,A
0051 A3                INC     DPTR
0052 7401              MOV     A,#01H
0054 F0                MOVX    @DPTR,A
0055 A3                INC     DPTR
0056 7400        E     MOV     A,#HIGH TX2_Buffer
0058 F0                MOVX    @DPTR,A
0059 A3                INC     DPTR
005A 7400        E     MOV     A,#LOW TX2_Buffer
005C F0                MOVX    @DPTR,A
005D 7B01              MOV     R3,#01H
005F 7A00        R     MOV     R2,#HIGH aes128+08H
0061 7900        R     MOV     R1,#LOW aes128+08H
0063 120000      E     LCALL   _app_encrypt_cbc
0066 900000      R     MOV     DPTR,#data_len
0069 EE                MOV     A,R6
006A F0                MOVX    @DPTR,A
006B A3                INC     DPTR
006C EF                MOV     A,R7
006D F0                MOVX    @DPTR,A
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 41  

                                           ; SOURCE LINE # 134
006E 7800        R     MOV     R0,#LOW tmp+02H
0070 7C00        R     MOV     R4,#HIGH tmp+02H
0072 7D01              MOV     R5,#01H
0074 7B01              MOV     R3,#01H
0076 7A00        R     MOV     R2,#HIGH aes128
0078 7900        R     MOV     R1,#LOW aes128
007A 7E00              MOV     R6,#00H
007C 7F08              MOV     R7,#08H
007E 120000      E     LCALL   ?C?COPY
                                           ; SOURCE LINE # 135
0081 900000      R     MOV     DPTR,#data_len
0084 E0                MOVX    A,@DPTR
0085 FC                MOV     R4,A
0086 A3                INC     DPTR
0087 E0                MOVX    A,@DPTR
0088 FD                MOV     R5,A
0089 EC                MOV     A,R4
008A 900000      R     MOV     DPTR,#tmp+0AH
008D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 136
008E ED                MOV     A,R5
008F A3                INC     DPTR
0090 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 138
0091 900000      E     MOV     DPTR,#?_crc16_2?BYTE+05H
0094 7401              MOV     A,#01H
0096 F0                MOVX    @DPTR,A
0097 A3                INC     DPTR
0098 7400        E     MOV     A,#HIGH TX2_Buffer
009A F0                MOVX    @DPTR,A
009B A3                INC     DPTR
009C 7400        E     MOV     A,#LOW TX2_Buffer
009E F0                MOVX    @DPTR,A
009F 900000      R     MOV     DPTR,#data_len
00A2 E0                MOVX    A,@DPTR
00A3 FF                MOV     R7,A
00A4 A3                INC     DPTR
00A5 E0                MOVX    A,@DPTR
00A6 900000      E     MOV     DPTR,#?_crc16_2?BYTE+08H
00A9 CF                XCH     A,R7
00AA F0                MOVX    @DPTR,A
00AB A3                INC     DPTR
00AC EF                MOV     A,R7
00AD F0                MOVX    @DPTR,A
00AE 7B01              MOV     R3,#01H
00B0 7A00        R     MOV     R2,#HIGH tmp
00B2 7900        R     MOV     R1,#LOW tmp
00B4 7D0C              MOV     R5,#0CH
00B6 7C00              MOV     R4,#00H
00B8 120000      E     LCALL   _crc16_2
00BB 900000      R     MOV     DPTR,#crc
00BE EE                MOV     A,R6
00BF F0                MOVX    @DPTR,A
00C0 A3                INC     DPTR
00C1 EF                MOV     A,R7
00C2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 140
00C3 7B01              MOV     R3,#01H
00C5 7A00        R     MOV     R2,#HIGH tmp
00C7 7900        R     MOV     R1,#LOW tmp
00C9 7D0C              MOV     R5,#0CH
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 42  

00CB 120000      E     LCALL   _Printf2
                                           ; SOURCE LINE # 141
00CE 7B01              MOV     R3,#01H
00D0 7A00        E     MOV     R2,#HIGH TX2_Buffer
00D2 7900        E     MOV     R1,#LOW TX2_Buffer
00D4 900000      R     MOV     DPTR,#data_len
00D7 A3                INC     DPTR
00D8 E0                MOVX    A,@DPTR
00D9 FD                MOV     R5,A
00DA 120000      E     LCALL   _Printf2
                                           ; SOURCE LINE # 142
00DD 900000      R     MOV     DPTR,#crc
00E0 E0                MOVX    A,@DPTR
00E1 FF                MOV     R7,A
00E2 120000      E     LCALL   _TX2_write2buff
                                           ; SOURCE LINE # 143
00E5 900000      R     MOV     DPTR,#crc
00E8 A3                INC     DPTR
00E9 E0                MOVX    A,@DPTR
00EA FF                MOV     R7,A
00EB 120000      E     LCALL   _TX2_write2buff
                                           ; SOURCE LINE # 144
00EE 7FE7              MOV     R7,#0E7H
00F0 120000      E     LCALL   _TX2_write2buff
                                           ; SOURCE LINE # 146
00F3 E4                CLR     A
00F4 900000      E     MOV     DPTR,#COM1+05H
00F7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 147
00F8 900000      E     MOV     DPTR,#COM1+04H
00FB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 148
                                           ; SOURCE LINE # 149
                                           ; SOURCE LINE # 150
00FC         ?C0014:
00FC 22                RET     
             ; FUNCTION uart1_check_TimeOut (END)

             ; FUNCTION uart2_check_TimeOut (BEGIN)
                                           ; SOURCE LINE # 152
                                           ; SOURCE LINE # 153
                                           ; SOURCE LINE # 156
0000 900000      E     MOV     DPTR,#COM2+05H
0003 E0                MOVX    A,@DPTR
0004 D3                SETB    C
0005 9400              SUBB    A,#00H
0007 4028              JC      ?C0017
                                           ; SOURCE LINE # 157
                                           ; SOURCE LINE # 158
0009 120000      E     LCALL   get_sys_ticks
;---- Variable 'count2' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 159
000C 900000      R     MOV     DPTR,#timerout2+02H
000F E0                MOVX    A,@DPTR
0010 FC                MOV     R4,A
0011 A3                INC     DPTR
0012 E0                MOVX    A,@DPTR
0013 FD                MOV     R5,A
0014 C3                CLR     C
0015 EF                MOV     A,R7
0016 9D                SUBB    A,R5
0017 FF                MOV     R7,A
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 43  

0018 EE                MOV     A,R6
0019 9C                SUBB    A,R4
001A FE                MOV     R6,A
001B C3                CLR     C
001C 900000      R     MOV     DPTR,#timerout2+01H
001F E0                MOVX    A,@DPTR
0020 9F                SUBB    A,R7
0021 900000      R     MOV     DPTR,#timerout2
0024 E0                MOVX    A,@DPTR
0025 9E                SUBB    A,R6
0026 5009              JNC     ?C0017
                                           ; SOURCE LINE # 160
                                           ; SOURCE LINE # 167
0028 E4                CLR     A
0029 900000      E     MOV     DPTR,#COM2+05H
002C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 168
002D 900000      E     MOV     DPTR,#COM2+04H
0030 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 169
                                           ; SOURCE LINE # 170
                                           ; SOURCE LINE # 171
0031         ?C0017:
0031 22                RET     
             ; FUNCTION uart2_check_TimeOut (END)

             ; FUNCTION usart1_cmd_write (BEGIN)
                                           ; SOURCE LINE # 176
                                           ; SOURCE LINE # 177
                                           ; SOURCE LINE # 181
0000 7B01              MOV     R3,#01H
0002 7A00        E     MOV     R2,#HIGH RX1_Buffer
0004 7900        E     MOV     R1,#LOW RX1_Buffer
0006 120000      E     LCALL   _printf
                                           ; SOURCE LINE # 182
0009 7800        R     MOV     R0,#LOW aes128
000B 7C00        R     MOV     R4,#HIGH aes128
000D 7D01              MOV     R5,#01H
000F 7B01              MOV     R3,#01H
0011 7A00        E     MOV     R2,#HIGH RX1_Buffer+01H
0013 7900        E     MOV     R1,#LOW RX1_Buffer+01H
0015 7E00              MOV     R6,#00H
0017 7F08              MOV     R7,#08H
0019 120000      E     LCALL   ?C?COPY
                                           ; SOURCE LINE # 183
001C 7800        R     MOV     R0,#LOW aes128+08H
001E 7C00        R     MOV     R4,#HIGH aes128+08H
0020 7D01              MOV     R5,#01H
0022 7B01              MOV     R3,#01H
0024 7A00        E     MOV     R2,#HIGH RX1_Buffer+09H
0026 7900        E     MOV     R1,#LOW RX1_Buffer+09H
0028 7E00              MOV     R6,#00H
002A 7F10              MOV     R7,#010H
002C 120000      E     LCALL   ?C?COPY
                                           ; SOURCE LINE # 184
002F 7800        R     MOV     R0,#LOW aes128+018H
0031 7C00        R     MOV     R4,#HIGH aes128+018H
0033 7D01              MOV     R5,#01H
0035 7B01              MOV     R3,#01H
0037 7A00        E     MOV     R2,#HIGH RX1_Buffer+019H
0039 7900        E     MOV     R1,#LOW RX1_Buffer+019H
003B 7E00              MOV     R6,#00H
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 44  

003D 7F10              MOV     R7,#010H
003F 120000      E     LCALL   ?C?COPY
                                           ; SOURCE LINE # 189
0042 7F06              MOV     R7,#06H
0044 7E00              MOV     R6,#00H
0046 120000      E     LCALL   _delay_ms
                                           ; SOURCE LINE # 190
0049 7BFF              MOV     R3,#0FFH
004B 7A00        R     MOV     R2,#HIGH ?SC_56
004D 7900        R     MOV     R1,#LOW ?SC_56
004F 7D02              MOV     R5,#02H
0051 120000      E     LCALL   _Printf1
                                           ; SOURCE LINE # 191
0054 7E00              MOV     R6,#00H
0056 7F80              MOV     R7,#080H
0058 7D00              MOV     R5,#00H
005A 7B01              MOV     R3,#01H
005C 7A00        E     MOV     R2,#HIGH RX1_Buffer
005E 7900        E     MOV     R1,#LOW RX1_Buffer
0060 120000      E     LCALL   ?C?MEMSET
                                           ; SOURCE LINE # 192
0063 E4                CLR     A
0064 900000      E     MOV     DPTR,#COM1+04H
0067 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 194
0068 22                RET     
             ; FUNCTION usart1_cmd_write (END)

             ; FUNCTION gprs_conf (BEGIN)
                                           ; SOURCE LINE # 195
                                           ; SOURCE LINE # 196
                                           ; SOURCE LINE # 197
0000 7F01              MOV     R7,#01H
0002 7E02              MOV     R6,#02H
0004 120000      E     LCALL   _EEPROM_SectorErase
                                           ; SOURCE LINE # 198
0007 7F06              MOV     R7,#06H
0009 7E00              MOV     R6,#00H
000B 120000      E     LCALL   _delay_ms
                                           ; SOURCE LINE # 199
000E 7B01              MOV     R3,#01H
0010 7A00        E     MOV     R2,#HIGH RX1_Buffer
0012 7900        E     MOV     R1,#LOW RX1_Buffer
0014 900000      E     MOV     DPTR,#COM1+04H
0017 E0                MOVX    A,@DPTR
0018 FF                MOV     R7,A
0019 900000      E     MOV     DPTR,#?_EEPROM_write_n?BYTE+05H
001C E4                CLR     A
001D F0                MOVX    @DPTR,A
001E A3                INC     DPTR
001F EF                MOV     A,R7
0020 F0                MOVX    @DPTR,A
0021 7F01              MOV     R7,#01H
0023 7E02              MOV     R6,#02H
0025 120000      E     LCALL   _EEPROM_write_n
                                           ; SOURCE LINE # 200
0028 7F06              MOV     R7,#06H
002A 7E00              MOV     R6,#00H
002C 120000      E     LCALL   _delay_ms
                                           ; SOURCE LINE # 201
002F 7BFF              MOV     R3,#0FFH
0031 7A00        R     MOV     R2,#HIGH ?SC_56
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 45  

0033 7900        R     MOV     R1,#LOW ?SC_56
0035 7D02              MOV     R5,#02H
0037 020000      E     LJMP    _Printf1
             ; FUNCTION gprs_conf (END)

             ; FUNCTION _MCU_check (BEGIN)
                                           ; SOURCE LINE # 208
0000 900000      R     MOV     DPTR,#check_time
0003 EE                MOV     A,R6
0004 F0                MOVX    @DPTR,A
0005 A3                INC     DPTR
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 209
                                           ; SOURCE LINE # 212
0008 900000      R     MOV     DPTR,#CT
000B E0                MOVX    A,@DPTR
000C 700F              JNZ     ?C0020
                                           ; SOURCE LINE # 213
                                           ; SOURCE LINE # 214
000E 120000      E     LCALL   get_sys_ticks
0011 900000      R     MOV     DPTR,#start_T
0014 EE                MOV     A,R6
0015 F0                MOVX    @DPTR,A
0016 A3                INC     DPTR
0017 EF                MOV     A,R7
0018 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 215
0019 A3                INC     DPTR
001A 7401              MOV     A,#01H
001C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 216
001D         ?C0020:
                                           ; SOURCE LINE # 218
001D 120000      E     LCALL   get_sys_ticks
0020 900000      R     MOV     DPTR,#start_T
0023 E0                MOVX    A,@DPTR
0024 FC                MOV     R4,A
0025 A3                INC     DPTR
0026 E0                MOVX    A,@DPTR
0027 FD                MOV     R5,A
0028 C3                CLR     C
0029 EF                MOV     A,R7
002A 9D                SUBB    A,R5
002B FF                MOV     R7,A
002C EE                MOV     A,R6
002D 9C                SUBB    A,R4
002E FE                MOV     R6,A
002F C3                CLR     C
0030 900000      R     MOV     DPTR,#check_time+01H
0033 E0                MOVX    A,@DPTR
0034 9F                SUBB    A,R7
0035 900000      R     MOV     DPTR,#check_time
0038 E0                MOVX    A,@DPTR
0039 9E                SUBB    A,R6
003A 5032              JNC     ?C0027
                                           ; SOURCE LINE # 219
                                           ; SOURCE LINE # 220
003C E4                CLR     A
003D 900000      R     MOV     DPTR,#CT
0040 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 221
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 46  

0041 209103            JB      LED1,?C0025
0044 309206            JNB     LED2,?C0023
0047         ?C0025:
0047 7E00              MOV     R6,#00H
0049 7F01              MOV     R7,#01H
004B 8004              SJMP    ?C0024
004D         ?C0023:
004D 7E00              MOV     R6,#00H
004F 7F00              MOV     R7,#00H
0051         ?C0024:
0051 EF                MOV     A,R7
0052 6401              XRL     A,#01H
0054 4E                ORL     A,R6
0055 700C              JNZ     ?C0022
                                           ; SOURCE LINE # 222
                                           ; SOURCE LINE # 223
0057 D293              SETB    LED_state1
                                           ; SOURCE LINE # 224
0059 7F10              MOV     R7,#010H
005B 7E27              MOV     R6,#027H
005D 120000      E     LCALL   _delay_ms
                                           ; SOURCE LINE # 225
0060 C293              CLR     LED_state1
                                           ; SOURCE LINE # 226
0062 22                RET     
0063         ?C0022:
                                           ; SOURCE LINE # 228
                                           ; SOURCE LINE # 229
0063 D294              SETB    GPIO_power
                                           ; SOURCE LINE # 230
0065 7FD0              MOV     R7,#0D0H
0067 7E07              MOV     R6,#07H
0069 120000      E     LCALL   _delay_ms
                                           ; SOURCE LINE # 231
006C C294              CLR     GPIO_power
                                           ; SOURCE LINE # 232
                                           ; SOURCE LINE # 233
                                           ; SOURCE LINE # 234
006E         ?C0027:
006E 22                RET     
             ; FUNCTION _MCU_check (END)

             ; FUNCTION usart1_and_usart2 (BEGIN)
                                           ; SOURCE LINE # 236
                                           ; SOURCE LINE # 237
                                           ; SOURCE LINE # 239
0000 900000      E     MOV     DPTR,#COM1+05H
0003 E0                MOVX    A,@DPTR
0004 D3                SETB    C
0005 9400              SUBB    A,#00H
0007 4056              JC      ?C0028
0009 900000      E     MOV     DPTR,#COM2+05H
000C E0                MOVX    A,@DPTR
000D 7050              JNZ     ?C0028
                                           ; SOURCE LINE # 240
                                           ; SOURCE LINE # 241
000F 900000      E     MOV     DPTR,#COM1+05H
0012 E0                MOVX    A,@DPTR
0013 14                DEC     A
0014 F0                MOVX    @DPTR,A
0015 7048              JNZ     ?C0028
                                           ; SOURCE LINE # 242
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 47  

                                           ; SOURCE LINE # 243
0017 900000      E     MOV     DPTR,#COM1+04H
001A E0                MOVX    A,@DPTR
001B D3                SETB    C
001C 9400              SUBB    A,#00H
001E 403A              JC      ?C0030
                                           ; SOURCE LINE # 244
                                           ; SOURCE LINE # 245
0020 E4                CLR     A
0021 900000      R     MOV     DPTR,#i
0024 F0                MOVX    @DPTR,A
0025 A3                INC     DPTR
0026 F0                MOVX    @DPTR,A
0027         ?C0031:
0027 900000      E     MOV     DPTR,#COM1+04H
002A E0                MOVX    A,@DPTR
002B FF                MOV     R7,A
002C 900000      R     MOV     DPTR,#i
002F E0                MOVX    A,@DPTR
0030 FC                MOV     R4,A
0031 A3                INC     DPTR
0032 E0                MOVX    A,@DPTR
0033 FD                MOV     R5,A
0034 C3                CLR     C
0035 9F                SUBB    A,R7
0036 EC                MOV     A,R4
0037 9400              SUBB    A,#00H
0039 501F              JNC     ?C0030
003B 7400        E     MOV     A,#LOW RX1_Buffer
003D 2D                ADD     A,R5
003E F582              MOV     DPL,A
0040 E4                CLR     A
0041 3400        E     ADDC    A,#HIGH RX1_Buffer
0043 F583              MOV     DPH,A
0045 E0                MOVX    A,@DPTR
0046 FF                MOV     R7,A
0047 120000      E     LCALL   _TX2_write2buff
004A 900000      R     MOV     DPTR,#i+01H
004D E0                MOVX    A,@DPTR
004E 04                INC     A
004F F0                MOVX    @DPTR,A
0050 70D5              JNZ     ?C0031
0052 900000      R     MOV     DPTR,#i
0055 E0                MOVX    A,@DPTR
0056 04                INC     A
0057 F0                MOVX    @DPTR,A
0058         ?C0043:
0058 80CD              SJMP    ?C0031
                                           ; SOURCE LINE # 246
005A         ?C0030:
                                           ; SOURCE LINE # 247
005A E4                CLR     A
005B 900000      E     MOV     DPTR,#COM1+04H
005E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 248
                                           ; SOURCE LINE # 249
005F         ?C0028:
                                           ; SOURCE LINE # 250
005F 900000      E     MOV     DPTR,#COM2+05H
0062 E0                MOVX    A,@DPTR
0063 D3                SETB    C
0064 9400              SUBB    A,#00H
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 48  

0066 4056              JC      ?C0040
0068 900000      E     MOV     DPTR,#COM1+05H
006B E0                MOVX    A,@DPTR
006C 7050              JNZ     ?C0040
                                           ; SOURCE LINE # 251
                                           ; SOURCE LINE # 252
006E 900000      E     MOV     DPTR,#COM2+05H
0071 E0                MOVX    A,@DPTR
0072 14                DEC     A
0073 F0                MOVX    @DPTR,A
0074 7048              JNZ     ?C0040
                                           ; SOURCE LINE # 253
                                           ; SOURCE LINE # 254
0076 900000      E     MOV     DPTR,#COM2+04H
0079 E0                MOVX    A,@DPTR
007A D3                SETB    C
007B 9400              SUBB    A,#00H
007D 403A              JC      ?C0036
                                           ; SOURCE LINE # 255
                                           ; SOURCE LINE # 256
007F E4                CLR     A
0080 900000      R     MOV     DPTR,#i
0083 F0                MOVX    @DPTR,A
0084 A3                INC     DPTR
0085 F0                MOVX    @DPTR,A
0086         ?C0037:
0086 900000      E     MOV     DPTR,#COM2+04H
0089 E0                MOVX    A,@DPTR
008A FF                MOV     R7,A
008B 900000      R     MOV     DPTR,#i
008E E0                MOVX    A,@DPTR
008F FC                MOV     R4,A
0090 A3                INC     DPTR
0091 E0                MOVX    A,@DPTR
0092 FD                MOV     R5,A
0093 C3                CLR     C
0094 9F                SUBB    A,R7
0095 EC                MOV     A,R4
0096 9400              SUBB    A,#00H
0098 501F              JNC     ?C0036
009A 7400        E     MOV     A,#LOW RX2_Buffer
009C 2D                ADD     A,R5
009D F582              MOV     DPL,A
009F E4                CLR     A
00A0 3400        E     ADDC    A,#HIGH RX2_Buffer
00A2 F583              MOV     DPH,A
00A4 E0                MOVX    A,@DPTR
00A5 FF                MOV     R7,A
00A6 120000      E     LCALL   _TX1_write2buff
00A9 900000      R     MOV     DPTR,#i+01H
00AC E0                MOVX    A,@DPTR
00AD 04                INC     A
00AE F0                MOVX    @DPTR,A
00AF 70D5              JNZ     ?C0037
00B1 900000      R     MOV     DPTR,#i
00B4 E0                MOVX    A,@DPTR
00B5 04                INC     A
00B6 F0                MOVX    @DPTR,A
00B7         ?C0044:
00B7 80CD              SJMP    ?C0037
                                           ; SOURCE LINE # 257
00B9         ?C0036:
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 49  

                                           ; SOURCE LINE # 258
00B9 E4                CLR     A
00BA 900000      E     MOV     DPTR,#COM2+04H
00BD F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 259
                                           ; SOURCE LINE # 260
                                           ; SOURCE LINE # 261
00BE         ?C0040:
00BE 22                RET     
             ; FUNCTION usart1_and_usart2 (END)

C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 50  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


uart2_check_TimeOut. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  count2 . . . . . . . . . . . . . . .  * REG *  DATA   U_INT    0006H  2
uint16_t . . . . . . . . . . . . . . .  TYPEDEF  -----  U_INT    -----  2
P0 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0080H  1
P1 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0090H  1
P2 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A0H  1
P3 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B0H  1
P4 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C0H  1
get_sys_ticks. . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
P5 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C8H  1
uart1_cmd. . . . . . . . . . . . . . .  EXTERN   XDATA  U_CHAR   -----  1
LED1 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0091H  1
int32_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  LONG     -----  4
LED2 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0092H  1
COMx_Define. . . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  7
  id . . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  TX_read. . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  TX_write . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  B_TX_busy. . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0003H  1
  RX_Cnt . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0004H  1
  RX_TimeOut . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0005H  1
  B_RX_OK. . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0006H  1
usart1_cmd_write . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
int16_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  INT      -----  2
LED_state1 . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0093H  1
IE . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A8H  1
COM1 . . . . . . . . . . . . . . . . .  EXTERN   XDATA  STRUCT   -----  7
COM2 . . . . . . . . . . . . . . . . .  EXTERN   XDATA  STRUCT   -----  7
size_t . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_INT    -----  2
_EEPROM_SectorErase. . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
uchar. . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
_printf. . . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
_EEPROM_read_n . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
IP . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B8H  1
RX1_Buffer . . . . . . . . . . . . . .  EXTERN   XDATA  ARRAY    -----  128
RX2_Buffer . . . . . . . . . . . . . .  EXTERN   XDATA  ARRAY    -----  128
TX2_Buffer . . . . . . . . . . . . . .  EXTERN   XDATA  ARRAY    -----  128
COMx_InitDefine. . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  13
  UART_Mode. . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  UART_BRT_Use . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  UART_BaudRate. . . . . . . . . . . .  MEMBER   -----  U_LONG   0002H  4
  Morecommunicate. . . . . . . . . . .  MEMBER   -----  U_CHAR   0006H  1
  UART_RxEnable. . . . . . . . . . . .  MEMBER   -----  U_CHAR   0007H  1
  BaudRateDouble . . . . . . . . . . .  MEMBER   -----  U_CHAR   0008H  1
  UART_Interrupt . . . . . . . . . . .  MEMBER   -----  U_CHAR   0009H  1
  UART_Polity. . . . . . . . . . . . .  MEMBER   -----  U_CHAR   000AH  1
  UART_P_SW. . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   000BH  1
  UART_RXD_TXD_Short . . . . . . . . .  MEMBER   -----  U_CHAR   000CH  1
CCON . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D8H  1
_EEPROM_write_n. . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
_Printf1 . . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
_Printf2 . . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
_strtok. . . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
S_config . . . . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  6
  baud . . . . . . . . . . . . . . . .  MEMBER   -----  PTR      0000H  3
  server . . . . . . . . . . . . . . .  MEMBER   -----  PTR      0003H  3
u8 . . . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 51  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


_os_wait2. . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
timerout1. . . . . . . . . . . . . . .  PUBLIC   XDATA  STRUCT   0003H  4
timerout2. . . . . . . . . . . . . . .  PUBLIC   XDATA  STRUCT   0007H  4
_crc16_2 . . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
SCON . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0098H  1
TCON . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0088H  1
_app_encrypt_cbc . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
usart1_and_usart2. . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  i. . . . . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0000H  2
GPIO_power . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0094H  1
B. . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00F0H  1
uint . . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_INT    -----  2
_TX1_write2buff. . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
_TX2_write2buff. . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
_MCU_check . . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  check_time . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0000H  2
  start_T. . . . . . . . . . . . . . .  STATIC   XDATA  U_INT    0000H  2
  CT . . . . . . . . . . . . . . . . .  STATIC   XDATA  U_CHAR   0002H  1
gprs_conf. . . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
ACC. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E0H  1
_uart1_set_TimeOut . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  ms . . . . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0000H  2
_uart2_set_TimeOut . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  ms . . . . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0000H  2
s_config . . . . . . . . . . . . . . .  PUBLIC   XDATA  STRUCT   000BH  6
uint8_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
_delay_ms. . . . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
aes128 . . . . . . . . . . . . . . . .  PUBLIC   XDATA  STRUCT   0011H  41
int8_t . . . . . . . . . . . . . . . .  TYPEDEF  -----  CHAR     -----  1
u32. . . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_LONG   -----  4
_USRT2_config. . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
u16. . . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_INT    -----  2
GPIO_InitTypeDef . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  2
  Mode . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  Pin. . . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
timer_out. . . . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  4
  ms . . . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0000H  2
  start. . . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0002H  2
function . . . . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  baud . . . . . . . . . . . . . . . .  AUTO     XDATA  U_LONG   0000H  4
  ptr. . . . . . . . . . . . . . . . .  AUTO     XDATA  PTR      0004H  3
  sta. . . . . . . . . . . . . . . . .  AUTO     XDATA  CHAR     0007H  1
wchar_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  CHAR     -----  1
AES128 . . . . . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  41
  id . . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  8
  key. . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0008H  16
  iv . . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0018H  16
  state. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0028H  1
PSW. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D0H  1
uint32_t . . . . . . . . . . . . . . .  TYPEDEF  -----  U_LONG   -----  4
uart1_check_TimeOut. . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  count1 . . . . . . . . . . . . . . .  * REG *  DATA   U_INT    0006H  2
  tmp. . . . . . . . . . . . . . . . .  AUTO     XDATA  ARRAY    0000H  20
  crc. . . . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0014H  2
  data_len . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0016H  2


MODULE INFORMATION:   STATIC OVERLAYABLE
C51 COMPILER V9.01   FUNCTION                                                              01/07/2019 14:26:17 PAGE 52  

   CODE SIZE        =   1329    ----
   CONSTANT SIZE    =     59    ----
   XDATA SIZE       =     58      40
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
